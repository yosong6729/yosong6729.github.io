<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>도메인 분석 설계 | Yosong6729 Blog</title>
<meta name=keywords content="jpa,spring boot"><meta name=description content="해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
요구사항 분석 위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.
기능목록
회원 기능
회원 등록, 조회
상품 기능
상품 등록, 수정, 조회
주문 기능
상품 주문, 주문 내역 조회, 주문 취소
기타 요구사항
상품은 재고 관리가 필요하다 상품 종류는 도서 음반, 영화가 있다. 상품은 카테고리로 구분할 수 있다."><meta name=author content="yosong6729"><link rel=canonical href=https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-%EC%84%A4%EA%B3%84/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-%EC%84%A4%EA%B3%84/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="도메인 분석 설계"><meta property="og:description" content="해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
요구사항 분석 위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.
기능목록
회원 기능
회원 등록, 조회
상품 기능
상품 등록, 수정, 조회
주문 기능
상품 주문, 주문 내역 조회, 주문 취소
기타 요구사항
상품은 재고 관리가 필요하다 상품 종류는 도서 음반, 영화가 있다. 상품은 카테고리로 구분할 수 있다."><meta property="og:type" content="article"><meta property="og:url" content="https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-%EC%84%A4%EA%B3%84/"><meta property="og:image" content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-09-20T16:55:02+09:00"><meta property="article:modified_time" content="2024-09-20T16:55:02+09:00"><meta property="og:site_name" content="Yosong6729 Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="도메인 분석 설계"><meta name=twitter:description content="해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
요구사항 분석 위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.
기능목록
회원 기능
회원 등록, 조회
상품 기능
상품 등록, 수정, 조회
주문 기능
상품 주문, 주문 내역 조회, 주문 취소
기타 요구사항
상품은 재고 관리가 필요하다 상품 종류는 도서 음반, 영화가 있다. 상품은 카테고리로 구분할 수 있다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yosong6729.github.io/post/"},{"@type":"ListItem","position":2,"name":"도메인 분석 설계","item":"https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-%EC%84%A4%EA%B3%84/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"도메인 분석 설계","name":"도메인 분석 설계","description":"해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n요구사항 분석 위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.\n기능목록\n회원 기능\n회원 등록, 조회\n상품 기능\n상품 등록, 수정, 조회\n주문 기능\n상품 주문, 주문 내역 조회, 주문 취소\n기타 요구사항\n상품은 재고 관리가 필요하다 상품 종류는 도서 음반, 영화가 있다. 상품은 카테고리로 구분할 수 있다.","keywords":["jpa","spring boot"],"articleBody":" 해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n요구사항 분석 위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.\n기능목록\n회원 기능\n회원 등록, 조회\n상품 기능\n상품 등록, 수정, 조회\n주문 기능\n상품 주문, 주문 내역 조회, 주문 취소\n기타 요구사항\n상품은 재고 관리가 필요하다 상품 종류는 도서 음반, 영화가 있다. 상품은 카테고리로 구분할 수 있다. 상품 주문시 배송 정보를 입력할 수 있다. 도메인 모델과 테이블 설계 회원, 주문, 상품의 관계: 회원은 여러 상품을 주문할 수 있다. 그리고 한 번 주문할 때 여러 상품을 선택할 수 있으므로 주문과 상품은 다대다 관계다. 하지만 이런 다대다 관계는 관계형 데이터베이스는 물론이고 엔티티에서도 거의 사용하 지 않는다. 따라서 그림처럼 주문상품이라는 엔티티를 추가해서 다대다 관계를 일대다, 다대일 관계로 풀어냈다\n상품 분류: 상품은 도서, 음반, 영화로 구분되는데 상품이라는 공통 속성을 사용하므로 상속 구조로 표현했다.\n참고: 테이블명이 ORDER가 아니라 ORDERS인 것은 데이터베이스가 order by때문에 예약어로 잡고 있는 경우가 많다. 그래서 관례상 ORDERS를 많이 사용한다.\n참고: 실제 코드에서는 DB에 소문자 + _(언더스코어) 스타일을 사용하겠다. 데이터베이스 테이블명, 컬럼명에 대한 관례는 회사마다 다르다. 보통은 대문자 + _(언더스코어)나 소문자 + _(언더스코어) 방식 중에 하나를 지정해서 일관성 있게 사용한다. 강의에서 설명할 때는 객체와 차이를 나타내기 위해데이터베이스 테이블, 컬럼명은 대문자를 사용했지만, 실제 코드에서는 소문자 + _(언더스코어) 스타일을 사용하겠다.\n회원 엔티티 분석 엔티티 분석에 대한 자세한 내용은 기본편에서도 확인할수 있으니 자세한 설명은 생략한다.\n회원이 주문을 하기 때문에, 회원이 주문리스트를 가지는 것은 얼핏 보면 잘 설계한 것 같지만, 객체 세상은 실제 세계와는 다르다. 회원을 통해서 주문이 일어나는게 아니라 주문을 생성할때 회원이 필요하다고 보는게 맞고 주문 내역이 필요하면 Order에서 필터링 조건이 들어가게 된다. 그래서 Member와 Order의 관계는 일대다가 맞지만 다대일의 양방향 연관관계를 설명하기 위해서 추가했다.\n회원 테이블 분석 Member: 회원 엔티티의 Address 임베디드 타입 정보가 회원 테이블에 그대로 들어갔다. 이것은 DELIVERY 테이블도 마찬가지다.\nITEM: 엘범, 도서, 영화 타입을 통합해서 하나의 테이블로 만들었다. DTYPE 컬럼으로 타입을 구분한다. 가장 단순한 싱글 테이블 전략을 사용한다.\n참고: 테이블명이 ORDER가 아니라 ORDER인 이유는 DB가 order by 때문에 예약어로 잡고 있는 경우가 많다. 그래서 관례상 ORDERS를 많이 사용한다.\n참고: 실제 코드에서는 DB에 소문자 + _(언더스코어) 스타일을 사용하겠다. 데이터베이스 테이블명, 컬럼명에 대한 관례는 회사마다 다르다. 보통은 대문자 + _(언더스코어)나 소문자 + _(언더스코어) 방식 중에 하나를 지정해서 일관성 있게 사용한다. 강의에서 설명할 때는 객체와 차이를 나타내기 위해 데이터베이스 테이블, 컬럼명은 대문자를 사용했지만, 실제 코드에서는 소문자 + _(언더스코어) 스타일을 사용하겠다.\n연관관계 매핑 분석 카테고리와 상품: @ManyToMany를 사용해서 매핑한다.(실무에서 @ManyToMany는 사용하지 말자. 여기서는 다대 다 관계를 예제로 보여주기 위해 추가했을 뿐이다)\n이전 기본편을 보았으면 위 사진을 이해하는 것은 어렵지 않기 때문에 자세한 설명은 생략한다.\n참고: 외래 키가 있는 곳을 연관관계의 주인으로 정해라.\n엔티티 클래스 개발 예제에서는 설명을 쉽게하기 위해 엔티티 클래스에 Getter, Setter를 모두 열고, 최대한 단순하게 설계 실무에서는 가급적 Getter는 열어두고, Setter는 꼭 필요한 경우에만 사용하는 것을 추천 참고: 이론적으로 Getter, Setter 모두 제공하지 않고, 꼭 필요한 별도의 메서드를 제공하는게 가장 이상적이다. 하지만 실무에서 엔티티의 데이터는 조회할 일이 너무 많으므로, Getter의 경우 모두 열어두는 것이 편리하다. Getter는 호출하는 것만으로 어떤 일이 발생하지 않지만 Setter는 호출하면 데이터가 변한다. 그래서 Setter를 남발하게 되면 엔티티가 도대체 왜 변경되는지 추적하기가 힘들어지기 때문에 엔티티를 변경할때는 Setter대신 변경 지점이 명확하도록 변경을 위한 비즈니스 메서드를 별도로 제공해야한다.\n회원 엔티티\n@Entity @Getter @Setter public class Member { @Id @GeneratedValue @Column(name = \"member_id\") private Long id; private String name; @Embedded private Address address; @OneToMany(mappedBy = \"member\") private List\u003cOrder\u003e orders = new ArrayList\u003c\u003e(); } 참고: 엔티티의 식별자는 id를 사용하고, PK 컬럼명은 member_id로 설정한다. 엔티티는 타입(예: Member)을 가지므로 id 필드로 쉽게 구분할 수 있지만, 테이블은 타입이 없어 구분이 어렵다. 일반적으로 테이블명 + id 형식을 사용하며, 객체에서는 id 대신 memberId를 사용할 수 있지만, 일관성을 유지하는 것이 중요하다.\n주문 엔티티\n@Entity @Table(name = \"orders\") @Getter @Setter public class Order { @Id @GeneratedValue @Column(name = \"order_id\") private Long id; @ManyToOne(fetch = FetchType.LAZY) @JoinColumn(name = \"member_id\") private Member member; //주문 회원 @OneToMany(mappedBy = \"order\", cascade = CascadeType.ALL) private List\u003cOrderItem\u003e orderItems = new ArrayList\u003c\u003e(); @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY) @JoinColumn(name = \"delivery_id\") private Delivery delivery; //배송정보 private LocalDateTime orderDate; //주문시간 @Enumerated(EnumType.STRING) private OrderStatus status; //주문상태 [ORDER, CANCEL] //==연관관계 메서드==// public void setMember(Member member) { this.member = member; member.getOrders().add(this); } public void addOrderItem(OrderItem orderItem) { orderItems.add(orderItem); orderItem.setOrder(this); } public void setDelivery(Delivery delivery) { this.delivery = delivery; delivery.setOrder(this); } } 주문상태\npublic enum OrderStatus { ORDER, CANCEL } 주문상품 엔티티\n@Entity @Table(name = \"order_item\") @Getter @Setter public class OrderItem { @Id @GeneratedValue @Column(name = \"order_item_id\") private Long id; @ManyToOne(fetch = FetchType.LAZY) @JoinColumn(name = \"item_id\") private Item item; //주문 상품 @ManyToOne(fetch = FetchType.LAZY) @JoinColumn(name = \"order_id\") private Order order; //주문 private int orderPrice; //주문 가격 private int count; //주문 수량 } 상품 엔티티\n@Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) @DiscriminatorColumn(name = \"dtype\") @Getter @Setter public abstract class Item { @Id @GeneratedValue @Column(name = \"item_id\") private Long id; private String name; private int price; private int stockQuantity; @ManyToMany(mappedBy = \"items\") private List\u003cCategory\u003e categories = new ArrayList\u003cCategory\u003e(); } 상품- 도서 엔티티\n@Entity @DiscriminatorValue(\"B\") @Getter @Setter public class Book extends Item { private String author; private String isbn; } 상품-음반 엔티티\n@Entity @DiscriminatorValue(\"A\") @Getter @Setter public class Album extends Item { private String artist; private String etc; } 상품-영화 엔티티\n@Entity @DiscriminatorValue(\"M\") @Getter @Setter public class Movie extends Item { private String director; private String actor; } 배송 엔티티\n@Entity @Getter @Setter public class Delivery { @Id @GeneratedValue @Column(name = \"delivery_id\") private Long id; @OneToOne(mappedBy = \"delivery\", fetch = FetchType.LAZY) private Order order; @Embedded private Address address; @Enumerated(EnumType.STRING) private DeliveryStatus status; //ENUM [READY(준비), COMP(배송)] } 배송 상태\npublic enum DeliveryStatus { READY, COMP } 카테고리 엔티티\n@Entity @Getter @Setter public class Category { @Id @GeneratedValue @Column(name = \"category_id\") private Long id; private String name; @ManyToMany @JoinTable(name = \"category_item\", joinColumns = @JoinColumn(name = \"category_id\"), inverseJoinColumns = @JoinColumn(name = \"item_id\")) private List\u003cItem\u003e items = new ArrayList\u003c\u003e(); @ManyToOne(fetch = FetchType.LAZY) @JoinColumn(name = \"parent_id\") private Category parent; @OneToMany(mappedBy = \"parent\") private List\u003cCategory\u003e child = new ArrayList\u003c\u003e(); //==연관관계 메서드==// public void addChildCategory(Category child) { this.child.add(child); child.setParent(this); } } 참고: 실무에서는 @ManyToMany를 사용하지 말아야한다. 중간 테이블에 컬럼을 추가 할수 없고, 세밀하게 쿼리 실행이 어렵다. 중간 엔티티를 만들어서 다대다 매핑을 일대다, 다대일 매핑으로 풀어내사 사용해야한다.\n주소 값 타입\n@Embeddable @Getter public class Address { private String city; private String street; private String zipcode; protected Address() { } public Address(String city, String street, String zipcode) { this.city = city; this.street = street; this.zipcode = zipcode; } } 참고: 값 타입은 변경 불가능하게 설계해야 한다. @Setter를 제거하고, 생성자에서 값을 모두 초기화해서 변경 불가능한 클래스를 만든다. JPA 스펙상 엔티티나 임베디드 타입은 자바 기본생성자를 public, protected로 설정해야 한다. public 보다는 protected가 더 안전하다. JPA가 이런 제약을 두는 이유는 JPA 구현 라이브러리가 객체를 생성할 때 리플랙션 같은 기술을 사용할 수 있도록 지원해야 하기 때문이다.\n엔티티 설계시 주의점 엔티티에는 가급적 Setter를 사용하지 말자\nSetter가 모두 열려있다. 변경 포인트가 너무 많아서, 유지보수가 어렵다. 나중에 리펙토링으로 Setter 제거\n모든 연관관계는 지연로딩으로 설정!\n즉시로딩(EAGER)은 예측이 어렵고, 어떤 SQL이 실행될지 추적하기 어렵다. 특히 JPQL을 실행할때 N + 1문제가 자주 발생한다. 실무에서는 지연로딩으로 설정해야한다. 연관된 엔티티를 함께 조회해야한다면 fetch join 또는 엔티티 그래프 기능을 사용한다. @XToOne 관계는 기본이 즉시로딩이여서 직접 지연로딩으로 설정 해야 한다. 컬렉션은 필드에서 초기화 하자.\n컬렉션은 필드에서 바로 초기화 하는것이 안전하다.\nnull 문제에서 안전하다 하이버네이트는 엔티티를 영속화 할때, 컬랙션을 감싸서 하이버네이트가 제공하는 내장 컬렉션으로 변경한다. 만약 getOrders() 처럼 임의의 메서드에서 컬력션을 잘못 생성하면 하이버네이트 내부 메커니즘에 문제가 발생 할 수 있다. 따라서 필드레벨에서 생성하는 것이 가장 안전하고, 코드도 간결하다. Member member = new Member(); System.out.println(member.getOrders().getClass()); em.persist(member); System.out.println(member.getOrders().getClass()); //출력 결과 class java.util.ArrayList class org.hibernate.collection.internal.PersistentBag ","wordCount":"1207","inLanguage":"en","image":"https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-09-20T16:55:02+09:00","dateModified":"2024-09-20T16:55:02+09:00","author":{"@type":"Person","name":"yosong6729"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%B6%84%EC%84%9D-%EC%84%A4%EA%B3%84/"},"publisher":{"@type":"Organization","name":"Yosong6729 Blog","logo":{"@type":"ImageObject","url":"https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yosong6729.github.io/ accesskey=h title="Yosong6729 블로그 (Alt + H)"><img src=https://yosong6729.github.io/apple-touch-icon.png alt aria-label=logo height=35>Yosong6729 블로그</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yosong6729.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://yosong6729.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yosong6729.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yosong6729.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">도메인 분석 설계</h1><div class=post-meta><span title='2024-09-20 16:55:02 +0900 KST'>September 20, 2024</span>&nbsp;·&nbsp;yosong6729&nbsp;|&nbsp;<a href=https://github.com/yosong6729/blog/tree/main/content/post/%eb%8f%84%eb%a9%94%ec%9d%b8%20%eb%b6%84%ec%84%9d%20%ec%84%a4%ea%b3%84/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ec%9a%94%ea%b5%ac%ec%82%ac%ed%95%ad-%eb%b6%84%ec%84%9d aria-label="요구사항 분석">요구사항 분석</a></li><li><a href=#%eb%8f%84%eb%a9%94%ec%9d%b8-%eb%aa%a8%eb%8d%b8%ea%b3%bc-%ed%85%8c%ec%9d%b4%eb%b8%94-%ec%84%a4%ea%b3%84 aria-label="도메인 모델과 테이블 설계">도메인 모델과 테이블 설계</a><ul><li><a href=#%ed%9a%8c%ec%9b%90-%ec%97%94%ed%8b%b0%ed%8b%b0-%eb%b6%84%ec%84%9d aria-label="회원 엔티티 분석">회원 엔티티 분석</a></li><li><a href=#%ed%9a%8c%ec%9b%90-%ed%85%8c%ec%9d%b4%eb%b8%94-%eb%b6%84%ec%84%9d aria-label="회원 테이블 분석">회원 테이블 분석</a></li><li><a href=#%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84-%eb%a7%a4%ed%95%91-%eb%b6%84%ec%84%9d aria-label="연관관계 매핑 분석">연관관계 매핑 분석</a></li></ul></li><li><a href=#%ec%97%94%ed%8b%b0%ed%8b%b0-%ed%81%b4%eb%9e%98%ec%8a%a4-%ea%b0%9c%eb%b0%9c aria-label="엔티티 클래스 개발">엔티티 클래스 개발</a></li><li><a href=#%ec%97%94%ed%8b%b0%ed%8b%b0-%ec%84%a4%ea%b3%84%ec%8b%9c-%ec%a3%bc%ec%9d%98%ec%a0%90 aria-label="엔티티 설계시 주의점">엔티티 설계시 주의점</a></li></ul></div></details></div><div class=post-content><blockquote><p>해당 글은 김영한님의 인프런 강의 <a href=https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1>스프링부트와 JPA활용1 - 웹 어플리케이션 개발</a>을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.</p></blockquote><h2 id=요구사항-분석>요구사항 분석<a hidden class=anchor aria-hidden=true href=#요구사항-분석>#</a></h2><p><img loading=lazy src=images/image.png alt=image.png></p><p>위 사진과 같은 형태로 개발할것이고 아래는 개발할 기능 목록이다.</p><p><strong>기능목록</strong></p><ul><li><p>회원 기능</p><p>회원 등록, 조회</p></li><li><p>상품 기능</p><p>상품 등록, 수정, 조회</p></li><li><p>주문 기능</p><p>상품 주문, 주문 내역 조회, 주문 취소</p></li><li><p>기타 요구사항</p><ul><li>상품은 재고 관리가 필요하다</li><li>상품 종류는 도서 음반, 영화가 있다.</li><li>상품은 카테고리로 구분할 수 있다.</li><li>상품 주문시 배송 정보를 입력할 수 있다.</li></ul></li></ul><hr><h2 id=도메인-모델과-테이블-설계>도메인 모델과 테이블 설계<a hidden class=anchor aria-hidden=true href=#도메인-모델과-테이블-설계>#</a></h2><p><img loading=lazy src=images/image%201.png alt=image.png></p><p><strong>회원, 주문, 상품의 관계</strong>: 회원은 여러 상품을 주문할 수 있다. 그리고 한 번 주문할 때 여러 상품을 선택할 수 있으므로 주문과 상품은 다대다 관계다. 하지만 이런 다대다 관계는 관계형 데이터베이스는 물론이고 엔티티에서도 거의 사용하
지 않는다. 따라서 그림처럼 주문상품이라는 엔티티를 추가해서 다대다 관계를 일대다, 다대일 관계로 풀어냈다</p><p><strong>상품 분류</strong>: 상품은 도서, 음반, 영화로 구분되는데 상품이라는 공통 속성을 사용하므로 상속 구조로 표현했다.</p><blockquote><p>참고: 테이블명이 <code>ORDER</code>가 아니라 <code>ORDERS</code>인 것은 데이터베이스가 <code>order by</code>때문에 예약어로 잡고 있는 경우가 많다. 그래서 관례상 <code>ORDERS</code>를 많이 사용한다.</p></blockquote><blockquote><p><strong>참고: 실제 코드에서는 DB에 소문자 + _(언더스코어) 스타일을 사용하겠다.</strong> 데이터베이스 테이블명, 컬럼명에 대한 관례는 회사마다 다르다. 보통은 대문자 + _(언더스코어)나 소문자 + _(언더스코어) 방식 중에 하나를 지정해서 일관성 있게 사용한다. 강의에서 설명할 때는 객체와 차이를 나타내기 위해데이터베이스 테이블, 컬럼명은 대문자를 사용했지만, <strong>실제 코드에서는 소문자 + _(언더스코어) 스타일을 사용하겠다.</strong></p></blockquote><h3 id=회원-엔티티-분석>회원 엔티티 분석<a hidden class=anchor aria-hidden=true href=#회원-엔티티-분석>#</a></h3><p><img loading=lazy src=images/image%202.png alt=image.png></p><p>엔티티 분석에 대한 자세한 내용은 기본편에서도 확인할수 있으니 자세한 설명은 생략한다.</p><p>회원이 주문을 하기 때문에, 회원이 주문리스트를 가지는 것은 얼핏 보면 잘 설계한 것 같지만, 객체 세상은 실제 세계와는 다르다. <strong>회원을 통해서 주문이 일어나는게 아니라 주문을 생성할때 회원이 필요하다고 보는게 맞고 주문 내역이 필요하면 Order에서 필터링 조건이 들어가게 된다.</strong> 그래서 Member와 Order의 관계는 일대다가 맞지만 다대일의 양방향 연관관계를 설명하기 위해서 추가했다.</p><h3 id=회원-테이블-분석>회원 테이블 분석<a hidden class=anchor aria-hidden=true href=#회원-테이블-분석>#</a></h3><p><img loading=lazy src=images/image%203.png alt=image.png></p><p><strong>Member:</strong> 회원 엔티티의 Address 임베디드 타입 정보가 회원 테이블에 그대로 들어갔다. 이것은 DELIVERY 테이블도 마찬가지다.</p><p><strong>ITEM</strong>: 엘범, 도서, 영화 타입을 통합해서 하나의 테이블로 만들었다. DTYPE 컬럼으로 타입을 구분한다. 가장 단순한 싱글 테이블 전략을 사용한다.</p><blockquote><p>참고: 테이블명이 ORDER가 아니라 ORDER인 이유는 DB가 order by 때문에 예약어로 잡고 있는 경우가 많다. 그래서 관례상 ORDERS를 많이 사용한다.</p></blockquote><blockquote><p><strong>참고: 실제 코드에서는 DB에 소문자 + _(언더스코어) 스타일을 사용하겠다.</strong> 데이터베이스 테이블명, 컬럼명에 대한 관례는 회사마다 다르다. 보통은 대문자 + _(언더스코어)나 소문자 + _(언더스코어) 방식 중에 하나를 지정해서 일관성 있게 사용한다. 강의에서 설명할 때는 객체와 차이를 나타내기 위해 데이터베이스 테이블, 컬럼명은 대문자를 사용했지만, <strong>실제 코드에서는 소문자 + _(언더스코어) 스타일을 사용하겠다.</strong></p></blockquote><h3 id=연관관계-매핑-분석>연관관계 매핑 분석<a hidden class=anchor aria-hidden=true href=#연관관계-매핑-분석>#</a></h3><p><strong>카테고리와 상품</strong>: @ManyToMany를 사용해서 매핑한다.<strong>(실무에서 @ManyToMany는 사용하지 말자. 여기서는 다대 다 관계를 예제로 보여주기 위해 추가했을 뿐이다)</strong></p><p>이전 기본편을 보았으면 위 사진을 이해하는 것은 어렵지 않기 때문에 자세한 설명은 생략한다.</p><blockquote><p><strong>참고: 외래 키가 있는 곳을 연관관계의 주인으로 정해라.</strong></p></blockquote><hr><h2 id=엔티티-클래스-개발>엔티티 클래스 개발<a hidden class=anchor aria-hidden=true href=#엔티티-클래스-개발>#</a></h2><ul><li>예제에서는 설명을 쉽게하기 위해 엔티티 클래스에 Getter, Setter를 모두 열고, 최대한 단순하게 설계</li><li><strong>실무에서는 가급적 Getter는 열어두고, Setter는 꼭 필요한 경우에만 사용하는 것을 추천</strong></li></ul><blockquote><p>참고: 이론적으로 Getter, Setter 모두 제공하지 않고, 꼭 필요한 별도의 메서드를 제공하는게 가장 이상적이다. 하지만 <strong>실무에서 엔티티의 데이터는 조회할 일이 너무 많으므로, Getter의 경우 모두 열어두는 것이 편리</strong>하다. Getter는 호출하는 것만으로 어떤 일이 발생하지 않지만 Setter는 호출하면 데이터가 변한다. 그래서 Setter를 남발하게 되면 엔티티가 도대체 왜 변경되는지 추적하기가 힘들어지기 때문에 <strong>엔티티를 변경할때는 Setter대신 변경 지점이 명확하도록 변경을 위한 비즈니스 메서드를 별도로 제공해야한다.</strong></p></blockquote><p><strong>회원 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Member</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;member_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Embedded</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Address</span><span class=w> </span><span class=n>address</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;member&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>참고: 엔티티의 식별자는 <code>id</code>를 사용하고, PK 컬럼명은 <code>member_id</code>로 설정한다. 엔티티는 타입(예: Member)을 가지므로 <code>id</code> 필드로 쉽게 구분할 수 있지만, 테이블은 타입이 없어 구분이 어렵다. 일반적으로 테이블명 + <code>id</code> 형식을 사용하며, 객체에서는 <code>id</code> 대신 <code>memberId</code>를 사용할 수 있지만, 일관성을 유지하는 것이 중요하다.</p></blockquote><p><strong>주문 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;orders&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Order</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;member_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=p>;</span><span class=w> </span><span class=c1>//주문 회원</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order&#34;</span><span class=p>,</span><span class=w> </span><span class=n>cascade</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CascadeType</span><span class=p>.</span><span class=na>ALL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>OrderItem</span><span class=o>&gt;</span><span class=w> </span><span class=n>orderItems</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToOne</span><span class=p>(</span><span class=n>cascade</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CascadeType</span><span class=p>.</span><span class=na>ALL</span><span class=p>,</span><span class=w> </span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;delivery_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Delivery</span><span class=w> </span><span class=n>delivery</span><span class=p>;</span><span class=w> </span><span class=c1>//배송정보</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>orderDate</span><span class=p>;</span><span class=w> </span><span class=c1>//주문시간</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Enumerated</span><span class=p>(</span><span class=n>EnumType</span><span class=p>.</span><span class=na>STRING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w> </span><span class=c1>//주문상태 [ORDER, CANCEL]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//==연관관계 메서드==//</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setMember</span><span class=p>(</span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>member</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>member</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>member</span><span class=p>.</span><span class=na>getOrders</span><span class=p>().</span><span class=na>add</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addOrderItem</span><span class=p>(</span><span class=n>OrderItem</span><span class=w> </span><span class=n>orderItem</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderItems</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>orderItem</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderItem</span><span class=p>.</span><span class=na>setOrder</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setDelivery</span><span class=p>(</span><span class=n>Delivery</span><span class=w> </span><span class=n>delivery</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>delivery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>delivery</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>delivery</span><span class=p>.</span><span class=na>setOrder</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>주문상태</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>enum</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ORDER</span><span class=p>,</span><span class=w> </span><span class=n>CANCEL</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>주문상품 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order_item&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderItem</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order_item_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;item_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Item</span><span class=w> </span><span class=n>item</span><span class=p>;</span><span class=w>    </span><span class=c1>//주문 상품</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=p>;</span><span class=w>    </span><span class=c1>//주문</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>orderPrice</span><span class=p>;</span><span class=w> </span><span class=c1>//주문 가격</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=p>;</span><span class=w>      </span><span class=c1>//주문 수량</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>상품 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;dtype&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>abstract</span><span class=w> </span><span class=kd>class</span> <span class=nc>Item</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;item_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>stockQuantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;items&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Category</span><span class=o>&gt;</span><span class=w> </span><span class=n>categories</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Category</span><span class=o>&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>상품- 도서 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorValue</span><span class=p>(</span><span class=s>&#34;B&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Book</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>author</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>isbn</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>상품-음반 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorValue</span><span class=p>(</span><span class=s>&#34;A&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Album</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>artist</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>etc</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>상품-영화 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorValue</span><span class=p>(</span><span class=s>&#34;M&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Movie</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>director</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>actor</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>배송 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Delivery</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;delivery_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToOne</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;delivery&#34;</span><span class=p>,</span><span class=w> </span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Embedded</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Address</span><span class=w> </span><span class=n>address</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Enumerated</span><span class=p>(</span><span class=n>EnumType</span><span class=p>.</span><span class=na>STRING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>DeliveryStatus</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w> </span><span class=c1>//ENUM [READY(준비), COMP(배송)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>배송 상태</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>enum</span><span class=w> </span><span class=n>DeliveryStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>READY</span><span class=p>,</span><span class=w> </span><span class=n>COMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>카테고리 엔티티</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Category</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;category_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToMany</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinTable</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;category_item&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>joinColumns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;category_id&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>inverseJoinColumns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;item_id&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Item</span><span class=o>&gt;</span><span class=w> </span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;parent_id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Category</span><span class=w> </span><span class=n>parent</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;parent&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Category</span><span class=o>&gt;</span><span class=w> </span><span class=n>child</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//==연관관계 메서드==//</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addChildCategory</span><span class=p>(</span><span class=n>Category</span><span class=w> </span><span class=n>child</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>child</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>child</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>child</span><span class=p>.</span><span class=na>setParent</span><span class=p>(</span><span class=k>this</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>참고: <strong>실무에서는 @ManyToMany를 사용하지 말아야한다</strong>. 중간 테이블에 컬럼을 추가 할수 없고, 세밀하게 쿼리 실행이 어렵다. <strong>중간 엔티티를 만들어서 다대다 매핑을 일대다, 다대일 매핑으로 풀어내사 사용해야한다.</strong></p></blockquote><p><strong>주소 값 타입</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Embeddable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Address</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>city</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>street</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>zipcode</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=nf>Address</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>Address</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>city</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>street</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>zipcode</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>city</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>city</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>street</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>street</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>zipcode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>zipcode</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>참고: <strong>값 타입은 변경 불가능하게 설계해야 한다.</strong>
<strong>@Setter를 제거하고, 생성자에서 값을 모두 초기화해서 변경 불가능한 클래스를 만든다.</strong> JPA 스펙상 엔티티나 임베디드 타입은 자바 기본생성자를 public, protected로 설정해야 한다. public 보다는 protected가 더 안전하다. JPA가 이런 제약을 두는 이유는 JPA 구현 라이브러리가 객체를 생성할 때 리플랙션 같은 기술을 사용할 수 있도록 지원해야 하기 때문이다.</p></blockquote><hr><h2 id=엔티티-설계시-주의점>엔티티 설계시 주의점<a hidden class=anchor aria-hidden=true href=#엔티티-설계시-주의점>#</a></h2><p><strong>엔티티에는 가급적 Setter를 사용하지 말자</strong></p><p>Setter가 모두 열려있다. 변경 포인트가 너무 많아서, 유지보수가 어렵다. 나중에 리펙토링으로 Setter 제거</p><p><strong>모든 연관관계는 지연로딩으로 설정!</strong></p><ul><li>즉시로딩(EAGER)은 예측이 어렵고, 어떤 SQL이 실행될지 추적하기 어렵다. 특히 JPQL을 실행할때 N + 1문제가 자주 발생한다.</li><li>실무에서는 지연로딩으로 설정해야한다.</li><li>연관된 엔티티를 함께 조회해야한다면 fetch join 또는 엔티티 그래프 기능을 사용한다.</li><li>@XToOne 관계는 기본이 즉시로딩이여서 직접 지연로딩으로 설정 해야 한다.</li></ul><p><strong>컬렉션은 필드에서 초기화 하자.</strong></p><p>컬렉션은 필드에서 바로 초기화 하는것이 안전하다.</p><ul><li>null 문제에서 안전하다</li><li>하이버네이트는 엔티티를 영속화 할때, 컬랙션을 감싸서 하이버네이트가 제공하는 내장 컬렉션으로 변경한다. 만약 getOrders() 처럼 임의의 메서드에서 컬력션을 잘못 생성하면 하이버네이트 내부 메커니즘에 문제가 발생
할 수 있다. 따라서 필드레벨에서 생성하는 것이 가장 안전하고, 코드도 간결하다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Member</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>member</span><span class=p>.</span><span class=na>getOrders</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>em</span><span class=p>.</span><span class=na>persist</span><span class=p>(</span><span class=n>member</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>member</span><span class=p>.</span><span class=na>getOrders</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//출력 결과</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>java</span><span class=p>.</span><span class=na>util</span><span class=p>.</span><span class=na>ArrayList</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>org</span><span class=p>.</span><span class=na>hibernate</span><span class=p>.</span><span class=na>collection</span><span class=p>.</span><span class=na>internal</span><span class=p>.</span><span class=na>PersistentBag</span><span class=w>
</span></span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://yosong6729.github.io/tags/jpa/>JPA</a></li><li><a href=https://yosong6729.github.io/tags/spring-boot/>Spring Boot</a></li></ul><nav class=paginav><a class=next href=https://yosong6729.github.io/post/%EA%B0%9D%EC%B2%B4%EC%A7%80%ED%96%A5-%EC%BF%BC%EB%A6%AC-%EC%96%B8%EC%96%B42---%EC%A4%91%EA%B8%89%EB%AC%B8%EB%B2%95/><span class=title>Next »</span><br><span>[자바 ORM 표준 JPA 프로그래밍 - 기본편] 객체지향 쿼리 언어2 - 중급문법</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yosong6729.github.io/>Yosong6729 Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>