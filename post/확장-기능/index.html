<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>확장 기능 | Yosong6729 Blog</title>
<meta name=keywords content="spring data JPA"><meta name=description content="해당 글은 김영한님의 인프런 강의 스프링 데이터 JPA을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
사용자 정의 리포지토리 구현 스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.
스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.
JPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?
사용저 정의 인터페이스"><meta name=author content="yosong6729"><link rel=canonical href=https://yosong6729.github.io/post/%ED%99%95%EC%9E%A5-%EA%B8%B0%EB%8A%A5/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yosong6729.github.io/post/%ED%99%95%EC%9E%A5-%EA%B8%B0%EB%8A%A5/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="확장 기능"><meta property="og:description" content="해당 글은 김영한님의 인프런 강의 스프링 데이터 JPA을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
사용자 정의 리포지토리 구현 스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.
스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.
JPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?
사용저 정의 인터페이스"><meta property="og:type" content="article"><meta property="og:url" content="https://yosong6729.github.io/post/%ED%99%95%EC%9E%A5-%EA%B8%B0%EB%8A%A5/"><meta property="og:image" content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-10-02T23:07:03+09:00"><meta property="article:modified_time" content="2024-10-02T23:07:03+09:00"><meta property="og:site_name" content="Yosong6729 Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="확장 기능"><meta name=twitter:description content="해당 글은 김영한님의 인프런 강의 스프링 데이터 JPA을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
사용자 정의 리포지토리 구현 스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.
스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.
JPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?
사용저 정의 인터페이스"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yosong6729.github.io/post/"},{"@type":"ListItem","position":2,"name":"확장 기능","item":"https://yosong6729.github.io/post/%ED%99%95%EC%9E%A5-%EA%B8%B0%EB%8A%A5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"확장 기능","name":"확장 기능","description":"해당 글은 김영한님의 인프런 강의 스프링 데이터 JPA을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n사용자 정의 리포지토리 구현 스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.\n스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.\nJPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?\n사용저 정의 인터페이스","keywords":["spring data JPA"],"articleBody":" 해당 글은 김영한님의 인프런 강의 스프링 데이터 JPA을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n사용자 정의 리포지토리 구현 스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.\n스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.\nJPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?\n사용저 정의 인터페이스\npublic interface MemberRepositoryCustom { List\u003cMember\u003e findMemberCustom(); } 사용자 정의 인터페이스 구현 클래스\n@RequiredArgsConstructor public class MemberRepositoryImpl implements MemberRepositoryCustom{ private final EntityManager em; @Override public List\u003cMember\u003e findMemberCustom() { return em.createQuery(\"select m from Member m\", Member.class) .getResultList(); } } 규칙: 리포지토리 인터페이스 이름 + Impl 스프링 데이터 2.x부터는 사용자 저으이 인터페이스 명 + Imple 방식도 지원 MemberRepositoryImple 대신에 MemberRepositoryCustomImple 같이 구현해도 된다. 기존 방식보다 이 방식이 인터페이스 이름과 구현 클래스 이름이 비슷해서 더 직관적이고 여러 인터페이스를 분리해서 구현하는 것도 가능하기때문에 새롭게 변경된 이 방식을 사용하는것을 더 권장한다.\n스프링 데이터 JPA가 인식해서 스프링 빈으로 등록한다. 사용자 정의 인터페이스 상속\npublic interface MemberRepository extends JpaRepository\u003cMember, Long\u003e, MemberRepositoryCustom{ } 사용자 정의 메서드 호출 코드\nList\u003cMember\u003e result = memberRepository.findMemberCustom(); Imple 대신 다른 이름으로 변경하는 방법\nXML 설정\n\u003crepositories base-package=\"study.datajpa.repository\" repository-impl-postfix=\"Impl\" /\u003e JavaConfig 설정\n@EnableJpaRepositories(basePackages = \"study.datajpa.repository\", repositoryImplementationPostfix = \"Impl\") 실무에서는 주로 QueryDSL이나 SpringJdbcTemplate을 함께 사용할 때 사용자 정의 리포지토리 기능 자주 사용\n항상 사용자 정의 리포지토리가 필요한 것은 아니다. 그냥 임의의 리포지토리를 만들어도 된다. 예를들어 MemberQueryRepository를 인터페이스가 아닌 클래스로 만들고 스프링 빈으로 등록해서 그냥 직접 사용해도 된다. 물론 이 경우 스프링 데이터 JPA와는 아무런 관계 없이 별도로 동작한다.\nAuditing 등록일, 수정일, 등록자, 수정자 등 엔티티를 생성, 변경할 때 변경한 사람과 시간을 추적하고 싶으면 어떻게 해야할까?\n순수 JPA 사용 우선 등록일, 수정일 적용\n@Getter @MappedSuperclass public class JpaBaseEntity { @Column(updatable = false) private LocalDateTime createdDate; private LocalDateTime updatedDate; @PrePersist public void prePersist() { LocalDateTime now = LocalDateTime.now(); createdDate = now; updatedDate = now; } @PreUpdate public void preUpdate() { updatedDate = LocalDateTime.now(); } } @Column(updatable = false)은 createdDate의 값이 변경되지 않도록한다.\n@PrePersist는 persist 하기전에 실행이되도록 한다. prePersist()에서 updatedDate = now의 필요성이 없다고 생각할수있지만 등록일과 수정일을 등록하면 최초 등로된 데이터인지 알수있고 업데이트에 null이 있으면 쿼리 하기가 되게 지저분해져서 값을 채워두는게 좋다.\n@PreUpdate는 업데이트 되기전에 실행된다.\npublic class Member extends JpaBaseEntity {} 확인 코드\n@Test public void jpaEventBaseEntity() throws Exception { //given Member member = new Member(\"member1\"); memberRepository.save(member); //@PrePersist Thread.sleep(100); member.setUsername(\"member2\"); em.flush(); //@PreUpdate em.clear(); //when Member findMember = memberRepository.findById(member.getId()).get(); //then System.out.println(\"findMember.createdDate = \" + findMember.getCreatedDate()); System.out.println(\"findMember.updatedDate = \" + findMember.getUpdatedDate()); } JPA 주요 이벤트 어노테이션\n@PrePersist, @PostPersist @PreUpdate, @PostUpdate 위 어노테이션의 자세한 정보는 공식문서를 참고하길 바라낟.\n스프링 데이터 JPA 사용 설정\n@EnableJpaAuditing → 스프링 부트 설정 클래스에 적용\n@EntityListeners(AuditingEntityListener.class) → 엔티티에 적용\n사용 어노테이션\n@CreatedDate, @LastModifiedDate, @CreatedBy, @LastModifiedBy\n스프링 데이터 Auditing 적용 - 등록일, 수정일\n@EntityListeners(AuditingEntityListener.class) @MappedSuperclass @Getter public class BaseEntity { @CreatedDate @Column(updatable = false) private LocalDateTime createdDate; @LastModifiedDate private LocalDateTime lastModifiedDate; } 스프링 데이터 Auditing 적용 - 등록자, 수정자\n@EntityListeners(AuditingEntityListener.class) @MappedSuperclass public class BaseEntity { @CreatedDate @Column(updatable = false) private LocalDateTime createdDate; @LastModifiedDate private LocalDateTime lastModifiedDate; @CreatedBy @Column(updatable = false) private String createdBy; @LastModifiedBy private String lastModifiedBy; } 등록자, 수정자를 처리해주는 AuditorAware 스프링 빈 등록\n@EnableJpaAuditing @SpringBootApplication public class DataJpaApplication { public static void main(String[] args) { SpringApplication.run(DataJpaApplication.class, args); } @Bean public AuditorAware\u003cString\u003e auditorProvider() { return () -\u003e Optional.of(UUID.randomUUID().toString()); } } DataJpaApplication에 @EnableJpaAuditing도 함께 등록해야 한다. 등록되거나 수정될때마다 auditorProvider를 호출해서 결과물을 꺼내고 createdBy, lastModifiedBy의 값들이 채워진다.\n실무에서는 세션 정보나, 스프링 시큐리티 로그인 정보에서 ID를 받는다.\n실무에서 대부분의 엔티티는 등록시간, 수정시간이 필요하지만, 등록자, 수정자는 없을 수도 있다. 그래서 다음과 같이 Base 타입을 분리하고, 원하는 타입을 선택해서 상속\npublic class BaseTimeEntity { @CreatedDate @Column(updatable = false) private LocalDateTime createdDate; @LastModifiedDate private LocalDateTime lastModifiedDate; } public class BaseEntity extends BaseTimeEntity { @CreatedBy @Column(updatable = false) private String createdBy; @LastModifiedBy private String lastModifiedBy; } 저장시점에 등록일, 등록자는 물론이고, 수정일, 수정자도 같은 데이터가 저장된다. 데이터가 중복 저장되는 것 같지만, 이렇게 해두면 변경 컬럼만 확인해도 마지막에 업데이트한 유저를 확인 할 수 있으므로 유지보수 관점에서 편리하다. 이렇게 하지 않으면 변경 컬럼이 null 일때 등록 컬럼을 또 찾아야한다.\n참고로 저장시점에 저장데이터만 입력하고 싶으면 @EnableJpaAuditing(modifyOnCreate = false)옵션을 사용하면 된다.\n전체 적용 @EntityListeners(AuditingEntityListener.class)를 생략하고 스프링 데이터 JPA가 제공하는 이벤트를 엔티티 전체에 적용하려면 orm.xml에 다음과 같이 등록하면 된다.\nMETA-INF/orm.xml\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e ","wordCount":"1154","inLanguage":"en","image":"https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-10-02T23:07:03+09:00","dateModified":"2024-10-02T23:07:03+09:00","author":{"@type":"Person","name":"yosong6729"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yosong6729.github.io/post/%ED%99%95%EC%9E%A5-%EA%B8%B0%EB%8A%A5/"},"publisher":{"@type":"Organization","name":"Yosong6729 Blog","logo":{"@type":"ImageObject","url":"https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yosong6729.github.io/ accesskey=h title="Yosong6729 블로그 (Alt + H)"><img src=https://yosong6729.github.io/apple-touch-icon.png alt aria-label=logo height=35>Yosong6729 블로그</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yosong6729.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://yosong6729.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yosong6729.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yosong6729.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">확장 기능</h1><div class=post-meta><span title='2024-10-02 23:07:03 +0900 KST'>October 2, 2024</span>&nbsp;·&nbsp;yosong6729&nbsp;|&nbsp;<a href=https://github.com/yosong6729/blog/tree/main/content/post/%ed%99%95%ec%9e%a5%20%ea%b8%b0%eb%8a%a5/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ec%82%ac%ec%9a%a9%ec%9e%90-%ec%a0%95%ec%9d%98-%eb%a6%ac%ed%8f%ac%ec%a7%80%ed%86%a0%eb%a6%ac-%ea%b5%ac%ed%98%84 aria-label="사용자 정의 리포지토리 구현">사용자 정의 리포지토리 구현</a></li><li><a href=#auditing aria-label=Auditing>Auditing</a><ul><li><a href=#%ec%88%9c%ec%88%98-jpa-%ec%82%ac%ec%9a%a9 aria-label="순수 JPA 사용">순수 JPA 사용</a></li><li><a href=#%ec%8a%a4%ed%94%84%eb%a7%81-%eb%8d%b0%ec%9d%b4%ed%84%b0-jpa-%ec%82%ac%ec%9a%a9 aria-label="스프링 데이터 JPA 사용">스프링 데이터 JPA 사용</a></li><li><a href=#%ec%a0%84%ec%b2%b4-%ec%a0%81%ec%9a%a9 aria-label="전체 적용">전체 적용</a></li></ul></li><li><a href=#web-%ed%99%95%ec%9e%a5---%eb%8f%84%eb%a9%94%ec%9d%b8-%ed%81%b4%eb%9e%98%ec%8a%a4-%ec%bb%a8%eb%b2%84%ed%84%b0 aria-label="Web 확장 - 도메인 클래스 컨버터">Web 확장 - 도메인 클래스 컨버터</a></li><li><a href=#web-%ed%99%95%ec%9e%a5---%ed%8e%98%ec%9d%b4%ec%a7%95%ea%b3%bc-%ec%a0%95%eb%a0%ac aria-label="Web 확장 - 페이징과 정렬">Web 확장 - 페이징과 정렬</a><ul><li><a href=#page-%eb%82%b4%ec%9a%a9%ec%9d%84-dto%eb%a1%9c-%eb%b3%80%ed%99%98%ed%95%98%ea%b8%b0 aria-label="Page 내용을 DTO로 변환하기">Page 내용을 DTO로 변환하기</a></li><li><a href=#page%eb%a5%bc-1%eb%b6%80%ed%84%b0-%ec%8b%9c%ec%9e%91%ed%95%98%ea%b8%b0 aria-label="Page를 1부터 시작하기">Page를 1부터 시작하기</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>해당 글은 김영한님의 인프런 강의 <a href=https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%8D%B0%EC%9D%B4%ED%84%B0-JPA-%EC%8B%A4%EC%A0%84>스프링 데이터 JPA</a>을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.</p></blockquote><hr><h2 id=사용자-정의-리포지토리-구현>사용자 정의 리포지토리 구현<a hidden class=anchor aria-hidden=true href=#사용자-정의-리포지토리-구현>#</a></h2><p>스프링 데이터 JPA 리포지토리는 인터페이스만 정의하면 구현체는 스프링이 자동으로 생성한다.</p><p>스프링 데이터 JPA가 제공하는 인터페이스를 직접 구현j하면 구현해야 하는 기능이 너무 많다.</p><p>JPA를 직접사용(EntityManager), 스프링 JDBC Template, MyBatis, 데이터베이스 커넥션 직접 사용, Querydls 등 다양한 이유로 인터페이스의 메서드를 직접 구현하고 싶다면 어떻게 해야할까?</p><p><strong>사용저 정의 인터페이스</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>MemberRepositoryCustom</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findMemberCustom</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>사용자 정의 인터페이스 구현 클래스</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberRepositoryImpl</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>MemberRepositoryCustom</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EntityManager</span><span class=w> </span><span class=n>em</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findMemberCustom</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>em</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=s>&#34;select m from Member m&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Member</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>getResultList</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>규칙: 리포지토리 인터페이스 이름 + Impl<ul><li>스프링 데이터 2.x부터는 사용자 저으이 인터페이스 명 + Imple 방식도 지원</li></ul></li></ul><p>MemberRepositoryImple 대신에 MemberRepositoryCustomImple 같이 구현해도 된다. 기존 방식보다 이 방식이 인터페이스 이름과 구현 클래스 이름이 비슷해서 더 직관적이고 여러 인터페이스를 분리해서 구현하는 것도 가능하기때문에 새롭게 변경된 이 방식을 사용하는것을 더 권장한다.</p><ul><li>스프링 데이터 JPA가 인식해서 스프링 빈으로 등록한다.</li></ul><p><strong>사용자 정의 인터페이스 상속</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>MemberRepository</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>JpaRepository</span><span class=o>&lt;</span><span class=n>Member</span><span class=p>,</span><span class=w> </span><span class=n>Long</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=n>MemberRepositoryCustom</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>사용자 정의 메서드 호출 코드</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findMemberCustom</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></div><p><strong>Imple 대신 다른 이름으로 변경하는 방법</strong></p><p><strong>XML 설정</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;</span><span class=n>repositories</span><span class=w> </span><span class=n>base</span><span class=o>-</span><span class=n>package</span><span class=o>=</span><span class=s>&#34;study.datajpa.repository&#34;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>repository</span><span class=o>-</span><span class=n>impl</span><span class=o>-</span><span class=n>postfix</span><span class=o>=</span><span class=s>&#34;Impl&#34;</span><span class=w> </span><span class=o>/&gt;</span><span class=w>
</span></span></span></code></pre></div><p><strong>JavaConfig 설정</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@EnableJpaRepositories</span><span class=p>(</span><span class=n>basePackages</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;study.datajpa.repository&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>repositoryImplementationPostfix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Impl&#34;</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>실무에서는 주로 QueryDSL이나 SpringJdbcTemplate을 함께 사용할 때 사용자 정의 리포지토리 기능 자주 사용</p></blockquote><blockquote><p>항상 사용자 정의 리포지토리가 필요한 것은 아니다. 그냥 임의의 리포지토리를 만들어도 된다. 예를들어 MemberQueryRepository를 인터페이스가 아닌 클래스로 만들고 스프링 빈으로 등록해서 그냥 직접 사용해도 된다. 물론 이 경우 스프링 데이터 JPA와는 아무런 관계 없이 별도로 동작한다.</p></blockquote><hr><h2 id=auditing>Auditing<a hidden class=anchor aria-hidden=true href=#auditing>#</a></h2><p>등록일, 수정일, 등록자, 수정자 등 엔티티를 생성, 변경할 때 변경한 사람과 시간을 추적하고 싶으면 어떻게 해야할까?</p><h3 id=순수-jpa-사용>순수 JPA 사용<a hidden class=anchor aria-hidden=true href=#순수-jpa-사용>#</a></h3><p>우선 등록일, 수정일 적용</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@MappedSuperclass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>JpaBaseEntity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>createdDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>updatedDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PrePersist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>prePersist</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>now</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>createdDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>now</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>updatedDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>now</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PreUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>preUpdate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>updatedDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>@Column(updatable = false)은 createdDate의 값이 변경되지 않도록한다.</p><p>@PrePersist는 persist 하기전에 실행이되도록 한다. prePersist()에서 updatedDate = now의 필요성이 없다고 생각할수있지만 등록일과 수정일을 등록하면 최초 등로된 데이터인지 알수있고 업데이트에 null이 있으면 쿼리 하기가 되게 지저분해져서 값을 채워두는게 좋다.</p><p>@PreUpdate는 업데이트 되기전에 실행된다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w> </span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Member</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>JpaBaseEntity</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span></code></pre></div><p><strong>확인 코드</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>jpaEventBaseEntity</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//given</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Member</span><span class=p>(</span><span class=s>&#34;member1&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>member</span><span class=p>);</span><span class=w> </span><span class=c1>//@PrePersist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>100</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>member</span><span class=p>.</span><span class=na>setUsername</span><span class=p>(</span><span class=s>&#34;member2&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>em</span><span class=p>.</span><span class=na>flush</span><span class=p>();</span><span class=w> </span><span class=c1>//@PreUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>em</span><span class=p>.</span><span class=na>clear</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//when</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Member</span><span class=w> </span><span class=n>findMember</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>member</span><span class=p>.</span><span class=na>getId</span><span class=p>()).</span><span class=na>get</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//then</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;findMember.createdDate = &#34;</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>findMember</span><span class=p>.</span><span class=na>getCreatedDate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;findMember.updatedDate = &#34;</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>findMember</span><span class=p>.</span><span class=na>getUpdatedDate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><img loading=lazy src=images/image.png alt=image.png></p><p>JPA 주요 이벤트 어노테이션</p><ul><li>@PrePersist, @PostPersist</li><li>@PreUpdate, @PostUpdate</li></ul><p>위 어노테이션의 자세한 정보는 공식문서를 참고하길 바라낟.</p><h3 id=스프링-데이터-jpa-사용><strong>스프링 데이터 JPA 사용</strong><a hidden class=anchor aria-hidden=true href=#스프링-데이터-jpa-사용>#</a></h3><p><strong>설정</strong></p><p>@EnableJpaAuditing → 스프링 부트 설정 클래스에 적용</p><p>@EntityListeners(AuditingEntityListener.class) → 엔티티에 적용</p><p><strong>사용 어노테이션</strong></p><p>@CreatedDate, @LastModifiedDate, @CreatedBy, @LastModifiedBy</p><p><strong>스프링 데이터 Auditing 적용 - 등록일, 수정일</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@EntityListeners</span><span class=p>(</span><span class=n>AuditingEntityListener</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@MappedSuperclass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BaseEntity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@CreatedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>createdDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@LastModifiedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>lastModifiedDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>스프링 데이터 Auditing 적용 - 등록자, 수정자</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@EntityListeners</span><span class=p>(</span><span class=n>AuditingEntityListener</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@MappedSuperclass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BaseEntity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@CreatedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>createdDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@LastModifiedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>lastModifiedDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@CreatedBy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>createdBy</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@LastModifiedBy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>lastModifiedBy</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>등록자, 수정자를 처리해주는 <code>AuditorAware</code> 스프링 빈 등록</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@EnableJpaAuditing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootApplication</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DataJpaApplication</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>SpringApplication</span><span class=p>.</span><span class=na>run</span><span class=p>(</span><span class=n>DataJpaApplication</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=n>AuditorAware</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>auditorProvider</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>Optional</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>DataJpaApplication에 @EnableJpaAuditing도 함께 등록해야 한다. 등록되거나 수정될때마다 auditorProvider를 호출해서 결과물을 꺼내고 createdBy, lastModifiedBy의 값들이 채워진다.</p><p>실무에서는 세션 정보나, 스프링 시큐리티 로그인 정보에서 ID를 받는다.</p><blockquote><p>실무에서 대부분의 엔티티는 등록시간, 수정시간이 필요하지만, 등록자, 수정자는 없을 수도 있다. 그래서 다음과 같이 Base 타입을 분리하고, 원하는 타입을 선택해서 상속</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BaseTimeEntity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@CreatedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>createdDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@LastModifiedDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>lastModifiedDate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BaseEntity</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>BaseTimeEntity</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@CreatedBy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Column</span><span class=p>(</span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>createdBy</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@LastModifiedBy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>lastModifiedBy</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>저장시점에 등록일, 등록자는 물론이고, 수정일, 수정자도 같은 데이터가 저장된다. 데이터가 중복 저장되는 것 같지만, 이렇게 해두면 변경 컬럼만 확인해도 마지막에 업데이트한 유저를 확인 할 수 있으므로 유지보수 관점에서 편리하다. 이렇게 하지 않으면 변경 컬럼이 null 일때 등록 컬럼을 또 찾아야한다.</p><p>참고로 저장시점에 저장데이터만 입력하고 싶으면 @EnableJpaAuditing(modifyOnCreate = false)옵션을 사용하면 된다.</p><h3 id=전체-적용>전체 적용<a hidden class=anchor aria-hidden=true href=#전체-적용>#</a></h3><p>@EntityListeners(AuditingEntityListener.class)를 생략하고 스프링 데이터 JPA가 제공하는 이벤트를 엔티티 전체에 적용하려면 orm.xml에 다음과 같이 등록하면 된다.</p><p>META-INF/orm.xml</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl> <span class=nt>&lt;entity-mappings</span> <span class=na>xmlns=</span><span class=s>&#34;http://xmlns.jcp.org/xml/ns/persistence/orm&#34;</span>
</span></span><span class=line><span class=cl> <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl> <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://xmlns.jcp.org/xml/ns/persistence/orm 
</span></span></span><span class=line><span class=cl><span class=s>http://xmlns.jcp.org/xml/ns/persistence/orm_2_2.xsd&#34;</span>
</span></span><span class=line><span class=cl> <span class=na>version=</span><span class=s>&#34;2.2&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=nt>&lt;persistence-unit-metadata&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;persistence-unit-defaults&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;entity-listeners&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;entity-listener</span> 
</span></span><span class=line><span class=cl><span class=na>class=</span><span class=s>&#34;org.springframework.data.jpa.domain.support.AuditingEntityListener&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/entity-listeners&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/persistence-unit-defaults&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/persistence-unit-metadata&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/entity-mappings&gt;</span>
</span></span></code></pre></div><hr><h2 id=web-확장---도메인-클래스-컨버터>Web 확장 - 도메인 클래스 컨버터<a hidden class=anchor aria-hidden=true href=#web-확장---도메인-클래스-컨버터>#</a></h2><p>HTTP 파라미터로 넘어온 엔티티의 아이디로 엔티티 객체를 찾아서 바인딩을 한다.</p><p><strong>도메인 클래스 컨버터 사용전</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberRepository</span><span class=w> </span><span class=n>memberRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>findMember</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>).</span><span class=na>get</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>member</span><span class=p>.</span><span class=na>getUsername</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>도메인 클래스 컨버터 사용 후</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberRepository</span><span class=w> </span><span class=n>memberRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>findMember</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>member</span><span class=p>.</span><span class=na>getUsername</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Http 요청은 회원 id를 받지만 도메인 클래스 컨버터ㅏ 중간에 동작해서 회원 엔티티 객체를 반환 해준다.</p><p>도메인 클래스 컨버터도 리포지토리(멤버로 지정해놓은 리포지토리)를 사용해서 엔티티를 찾는다.</p><p><strong>주의</strong>
도메인 클래스 컨버터로 엔티티를 파라미터로 받으면, 이 엔티티는 단순 조회용으로만 사용해야 한다. (트랜잭션이 없는 범위에서 엔티티를 조회했으므로, 엔티티를 변경해도 DB에 반영되지 않는다.)</p><hr><h2 id=web-확장---페이징과-정렬>Web 확장 - 페이징과 정렬<a hidden class=anchor aria-hidden=true href=#web-확장---페이징과-정렬>#</a></h2><p>스프링 데이터가 제공하는 페이징과 정렬 기능을 스프링 MVC에서 편리하게 사용할 수 있다.</p><p><strong>페이징과 정렬 예제</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=n>Pageable</span><span class=w> </span><span class=n>pageable</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=n>page</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findAll</span><span class=p>(</span><span class=n>pageable</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>page</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>파라미터로 Pagealbe을 받는 것이 가능하다. Pageable은 인터페이스, 실제는 org.springframework.data.domain.PageRequest 객체를 생성한다.</p><p><strong>요청 파라미터</strong></p><ul><li>ex) /members?page=0&amp;size=3&amp;sort=id,desc&amp;sort=username,desc</li><li>page: 현재 페이지, <strong>0부터 시작한다.</strong></li><li>size: 한 페이지에 노출할 데이터 건수(디폴트 값은 20)</li><li>sort: 정렬 조건을 정의한다. 예) 정렬 속성,정렬 속성&mldr;(ASC | DESC), 정렬 방향을 변경하고 싶으면 sort 파라미터 추가(asc 생략 가능)</li></ul><p><strong>기본값</strong></p><ul><li>글로벌 설정: 스프링 부트</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>spring.data.web.pageable.default-page-size=20 /# 기본 페이지 사이즈/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>spring.data.web.pageable.max-page-size=2000 /# 최대 페이지 사이즈/</span><span class=w>
</span></span></span></code></pre></div><ul><li>개별 설정</li></ul><p>@PageableDefault 어노테이션 사용</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;/members_page&#34;</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=nd>@PageableDefault</span><span class=p>(</span><span class=n>size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>12</span><span class=p>,</span><span class=w> </span><span class=n>sort</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;username&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>direction</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Sort</span><span class=p>.</span><span class=na>Direction</span><span class=p>.</span><span class=na>DESC</span><span class=p>)</span><span class=w> </span><span class=n>Pageable</span><span class=w> </span><span class=n>pageable</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>접두사</strong></p><ul><li>페이징 정보가 둘 이상이면 접두사로 구분</li><li>@Qualifier에 접두사명 추가 &ldquo;{접두사명}_xxx”</li><li>ex) /members?member_page=0&amp;order_page=1</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Qualifier</span><span class=p>(</span><span class=s>&#34;member&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Pageable</span><span class=w> </span><span class=n>memberPageable</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Qualifier</span><span class=p>(</span><span class=s>&#34;order&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Pageable</span><span class=w> </span><span class=n>orderPageable</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w>
</span></span></span></code></pre></div><h3 id=page-내용을-dto로-변환하기>Page 내용을 DTO로 변환하기<a hidden class=anchor aria-hidden=true href=#page-내용을-dto로-변환하기>#</a></h3><p>엔티티를 API로 노출하면 다양한 문제가 발생한다. 그래서 엔티티를 꼭 DTO로 변환해서 반환해야 한다. Page는 map()을 지원해서 내부 데이터를 다른 것으로 변경 할 수 있따.</p><p><strong>MemberDTO</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberDto</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>username</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=nf>MemberDto</span><span class=p>(</span><span class=n>Member</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=na>getId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=na>getUsername</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Page.map() 사용</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>MemberDto</span><span class=o>&gt;</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=n>Pageable</span><span class=w> </span><span class=n>pageable</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=n>page</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findAll</span><span class=p>(</span><span class=n>pageable</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>MemberDto</span><span class=o>&gt;</span><span class=w> </span><span class=n>pageDto</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>page</span><span class=p>.</span><span class=na>map</span><span class=p>(</span><span class=n>MemberDto</span><span class=p>::</span><span class=k>new</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>pageDto</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//코드 최적화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Page</span><span class=o>&lt;</span><span class=n>MemberDto</span><span class=o>&gt;</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=n>Pageable</span><span class=w> </span><span class=n>pageable</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>memberRepository</span><span class=p>.</span><span class=na>findAll</span><span class=p>(</span><span class=n>pageable</span><span class=p>).</span><span class=na>map</span><span class=p>(</span><span class=n>MemberDto</span><span class=p>::</span><span class=k>new</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=page를-1부터-시작하기>Page를 1부터 시작하기<a hidden class=anchor aria-hidden=true href=#page를-1부터-시작하기>#</a></h3><ul><li>스프링 데이터는 Page를 0부터 시작한다.</li><li>1부터 시작하는 방법은?<ul><li>Pageable, Page를 파리미터와 응답 값으로 사용히지 않고, 직접 클래스를 만들어서 처리한다. 그리고 직접 PageRequest(Pageable 구현체)를 생성해서 리포지토리에 넘긴다. 물론 응답값도 Page 대신에 직접만들어서 제공해야 한다.</li><li>spring.data.web.pageable.one-indexed-parameters를 true로 설정한다. 그런데 이 방법은 web에서 page 파라미터를 -1 처리 할 뿐이다. 즉, page = 0가 page = 1 이 동일하다. 따라서 응답값인 Page에 모두 0 페이지 인덱스를 사용하는 한계가 있다.</li></ul></li></ul><p>one-indexed-parameters Page 1요청(http://localhost:8080/members?page=1)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=nt>&#34;content&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=err>...</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;pageable&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;offset&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;pageSize&#34;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;pageNumber&#34;</span><span class=p>:</span> <span class=mi>0</span> <span class=c1>//0 인덱스
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;number&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=c1>//0 인덱스
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nt>&#34;empty&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>page의 값이 1이어도 pageNumber와 number의 값은 0으로 반환한다. 위의 한계 때문에 이 방법은 권장하지 않는다.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://yosong6729.github.io/tags/spring-data-jpa/>Spring Data JPA</a></li></ul><nav class=paginav><a class=next href=https://yosong6729.github.io/post/%EC%BF%BC%EB%A6%AC-%EB%A9%94%EC%86%8C%EB%93%9C-%EA%B8%B0%EB%8A%A5/><span class=title>Next »</span><br><span>쿼리 메소드 기능</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yosong6729.github.io/>Yosong6729 Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>