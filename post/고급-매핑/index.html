<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑 | Yosong6729 Blog</title>
<meta name=keywords content="JPA"><meta name=description content="해당 글은 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
상속관계 매핑 관계형 데이터베이스는 상속 관계X 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사 상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑 슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법 각각 테이블로 변환 → 조인 전략 통합 테이블로 변환 → 단일 테이블 전략 서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략 주요 어노테이션 @Inheritance(strategy=InheritanceType."><meta name=author content="yosong6729"><link rel=canonical href=https://yosong6729.github.io/post/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yosong6729.github.io/post/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑"><meta property="og:description" content="해당 글은 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
상속관계 매핑 관계형 데이터베이스는 상속 관계X 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사 상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑 슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법 각각 테이블로 변환 → 조인 전략 통합 테이블로 변환 → 단일 테이블 전략 서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략 주요 어노테이션 @Inheritance(strategy=InheritanceType."><meta property="og:type" content="article"><meta property="og:url" content="https://yosong6729.github.io/post/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/"><meta property="og:image" content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-09-14T22:36:31+09:00"><meta property="article:modified_time" content="2024-09-14T22:36:31+09:00"><meta property="og:site_name" content="Yosong6729 Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑"><meta name=twitter:description content="해당 글은 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
상속관계 매핑 관계형 데이터베이스는 상속 관계X 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사 상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑 슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법 각각 테이블로 변환 → 조인 전략 통합 테이블로 변환 → 단일 테이블 전략 서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략 주요 어노테이션 @Inheritance(strategy=InheritanceType."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yosong6729.github.io/post/"},{"@type":"ListItem","position":2,"name":"[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑","item":"https://yosong6729.github.io/post/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑","name":"[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑","description":"해당 글은 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n상속관계 매핑 관계형 데이터베이스는 상속 관계X 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사 상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑 슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법 각각 테이블로 변환 → 조인 전략 통합 테이블로 변환 → 단일 테이블 전략 서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략 주요 어노테이션 @Inheritance(strategy=InheritanceType.","keywords":["JPA"],"articleBody":" 해당 글은 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n상속관계 매핑 관계형 데이터베이스는 상속 관계X 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사 상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑 슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법 각각 테이블로 변환 → 조인 전략 통합 테이블로 변환 → 단일 테이블 전략 서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략 주요 어노테이션 @Inheritance(strategy=InheritanceType.XXX) JOINED: 조인 전략 SINGLE_TABLE: 단일 테이블 전략 TABLE_PER_CLASS: 구현 클래스마다 테이블 전략 @DiscriminatorColumn(name=“DTYPE”) @DiscriminatorValue(“XXX”) 자식 클래스의 DTYPE 이름을 변경할때 사용한다.기본값은 엔티티 명이다. 조인 전략 코드 간략화 ITEM 엔티티\n@Entity @Inheritance(strategy = InheritanceType.JOINED) @DiscriminatorColumn public class Item{ @Id @GeneratedValue private Long id; private String name; private int price; ... } ALBUM 엔티티\n@Entity @DiscriminatorValue(\"A\") //DB의 DTYPE에 저장되는 이름 바꾸기 public class Album extends Item{ private String artist; ... } MOVIE 엔티티\n@Entity public class Movie extends Item{ private String director; private String actor; ... } BOOK엔티티\n@Entity public class Book extends Item{ private String author; private String isbn; ... } ITEM의 name, price가 중복이 안되고 ALBUM, MOVIE, BOOK이 각가 다른 데이터들이 있는 방식으로 DB를 잘 정규화한 모델링이고 JPA와 가장 유사한 모델이다.\n장점\n테이블 정규화 외래 키 참조 무결성 제약 조건 활용가능 저장공간 효율화 단점\n조회시 조인을 많이 사용, 성능 저하 조회 쿼리가 복잡함 데이터 저장시 INSERT SQL 2번 호출 단일 테이블 전략 코드 간략화 @Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) public class Item{ @Id @GeneratedValue private Long id; private String name; private int price; ... } @Inheritance(strategy = InheritanceType.SINGLE_TABLE)로 변경해주면 된다. 단일 테이블 전략은 ALBUM, MOVIE, BOOK 인지 알기 위해서 @DiscriminatorColumn이 필수 이기때문에 @DiscriminatorColumn적지 않아도 생성된다.\n장점\n조인이 필요 없으므로 일반적으로 조회 성능이 빠름 조회 쿼리가 단순함 단점\n자식 엔티티가 매핑한 컬럼은 모두 null 허용 단일 테이블에 모든 것을 저장하므로 테이블이 커질 수 있다. 상황에 따라서 조회 성능이 오히려 느려질 수 있다. 구현 클래스 마다 테이블 전략 코드 간략화 @Entity @Inheritance(strategy = InheritanceType.SINGLE_TABLE) public abstract class Item{ @Id @GeneratedValue private Long id; private String name; private int price; ... } Item 클래스를 abstract로 변경하고 @Inheritance(strategy = InheritanceType.SINGLE_TABLE)로 변경해주면 된다.\n이 전략은 데이터베이스 설계자와 ORM 전문가 둘 다 추천X\n장점\n서브 타입을 명확하게 구분해서 처리할 때 효과적 not null 제약조건 사용 가능 단점\n여러 자식 테이블을 함계 조회할 때 성능이 느림(UNION SQL 필요) 자식 테이블을 통합해서 쿼리하기 어려움 전략 선택 기본적으로는 조인전략을 가지고 가는데 조인전략의 장단점이랑 단일 테이블 전략의 장단점 두가지를 가지고 뭘할지 결정하면된다.\n@MappedSuperclass 공통 매핑 정보가 필요할 때 사용(id, name) 코드 간략화 @MappedSuperClass public class BaseEntity{ .... } @MapedSuperClass 필요\n@Entity public class Member extends BaseEntity{ ... } BaseEntity 상속\nDB는 Member와 Seller를 따로 사용하지만, 객체 입장에서 Member와 Seller의 id, name의 속성만 상속 받고 싶을때 사용한다. 예를 들어서 모든 테이블에 마지막으로 수정한 사람 이름과 날짜가 필요한 상황에서 공통으로 필요하기때문에 이같은 상황에서 사용 가능하다.\n상속관계 매핑x 엔티티X, 테이블과 매핑X 부모 클래스를 상속 받는 자식 클래스에 매핑 정보만 제공 조회, 검색 불가(em.find(BaseEntity) 불가) 테이블과 관계 없고, 단순히 엔티티가 공통으로 사용하는 매핑 정보를 모으는 역할 주로 등록일, 수정일, 등록자, 수정자 같은 전체 엔티티에서 공통으로 적용하는 정보를 모을 때 사용 참고: @Entity 클래스는 엔티티나 @MappedSuperclass로 지 정한 클래스만 상속 가능 실전 예제 - 4. 상속관계 매핑 실전 예제의 코드를 확인하고 싶으면 김영한님의 인프런 강의 자바 ORM 표준 JPA 프로그래밍 - 기본편에서 확인 하실수 있습니다.\n요구사항 추가 상품의 종류는 음반, 도서, 영화가 있고 이후 더 확장될 수 있다. 모든 데이터는 등록일과 수정일이 필수다. 도메인 모델 도메인 모델 상세 테이블 설계 ","wordCount":"566","inLanguage":"en","image":"https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-09-14T22:36:31+09:00","dateModified":"2024-09-14T22:36:31+09:00","author":{"@type":"Person","name":"yosong6729"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yosong6729.github.io/post/%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/"},"publisher":{"@type":"Organization","name":"Yosong6729 Blog","logo":{"@type":"ImageObject","url":"https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yosong6729.github.io/ accesskey=h title="Yosong6729 블로그 (Alt + H)"><img src=https://yosong6729.github.io/apple-touch-icon.png alt aria-label=logo height=35>Yosong6729 블로그</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yosong6729.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://yosong6729.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yosong6729.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yosong6729.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">[자바 ORM 표준 JPA 프로그래밍 - 기본편] 고급 매핑</h1><div class=post-meta><span title='2024-09-14 22:36:31 +0900 KST'>September 14, 2024</span>&nbsp;·&nbsp;yosong6729&nbsp;|&nbsp;<a href=https://github.com/yosong6729/blog/tree/main/content/post/%ea%b3%a0%ea%b8%89%20%eb%a7%a4%ed%95%91/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ec%83%81%ec%86%8d%ea%b4%80%ea%b3%84-%eb%a7%a4%ed%95%91 aria-label="상속관계 매핑">상속관계 매핑</a><ul><li><a href=#%ec%8a%88%ed%8d%bc-%ed%83%80%ec%9e%85-%ec%84%9c%eb%b8%8c%ed%83%80%ec%9e%85-%eb%85%bc%eb%a6%ac-%eb%aa%a8%eb%8d%b8%ec%9d%84-%ec%8b%a4%ec%a0%9c-%eb%ac%bc%eb%a6%ac-%eb%aa%a8%eb%8d%b8%eb%a1%9c-%ea%b5%ac%ed%98%84%ed%95%98%eb%8a%94-%eb%b0%a9%eb%b2%95 aria-label="슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법">슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법</a></li><li><a href=#%ec%a3%bc%ec%9a%94-%ec%96%b4%eb%85%b8%ed%85%8c%ec%9d%b4%ec%85%98 aria-label="주요 어노테이션">주요 어노테이션</a></li><li><a href=#%ec%a1%b0%ec%9d%b8-%ec%a0%84%eb%9e%b5 aria-label="조인 전략">조인 전략</a></li><li><a href=#%eb%8b%a8%ec%9d%bc-%ed%85%8c%ec%9d%b4%eb%b8%94-%ec%a0%84%eb%9e%b5 aria-label="단일 테이블 전략">단일 테이블 전략</a></li><li><a href=#%ea%b5%ac%ed%98%84-%ed%81%b4%eb%9e%98%ec%8a%a4-%eb%a7%88%eb%8b%a4-%ed%85%8c%ec%9d%b4%eb%b8%94-%ec%a0%84%eb%9e%b5 aria-label="구현 클래스 마다 테이블 전략">구현 클래스 마다 테이블 전략</a></li><li><a href=#%ec%a0%84%eb%9e%b5-%ec%84%a0%ed%83%9d aria-label="전략 선택">전략 선택</a></li></ul></li><li><a href=#mappedsuperclass aria-label=@MappedSuperclass>@MappedSuperclass</a></li><li><a href=#%ec%8b%a4%ec%a0%84-%ec%98%88%ec%a0%9c---4-%ec%83%81%ec%86%8d%ea%b4%80%ea%b3%84-%eb%a7%a4%ed%95%91 aria-label="실전 예제 - 4. 상속관계 매핑">실전 예제 - 4. 상속관계 매핑</a><ul><li><a href=#%ec%9a%94%ea%b5%ac%ec%82%ac%ed%95%ad-%ec%b6%94%ea%b0%80 aria-label="요구사항 추가">요구사항 추가</a></li><li><a href=#%eb%8f%84%eb%a9%94%ec%9d%b8-%eb%aa%a8%eb%8d%b8 aria-label="도메인 모델">도메인 모델</a></li><li><a href=#%eb%8f%84%eb%a9%94%ec%9d%b8-%eb%aa%a8%eb%8d%b8-%ec%83%81%ec%84%b8 aria-label="도메인 모델 상세">도메인 모델 상세</a></li><li><a href=#%ed%85%8c%ec%9d%b4%eb%b8%94-%ec%84%a4%ea%b3%84 aria-label="테이블 설계">테이블 설계</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>해당 글은 김영한님의 인프런 강의 <a href=https://www.inflearn.com/course/ORM-JPA-Basic>자바 ORM 표준 JPA 프로그래밍 - 기본편</a>을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.</p></blockquote><hr><h2 id=상속관계-매핑>상속관계 매핑<a hidden class=anchor aria-hidden=true href=#상속관계-매핑>#</a></h2><ul><li>관계형 데이터베이스는 상속 관계X</li><li>슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사</li><li>상속관계 매핑: 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑</li></ul><p><img loading=lazy src=images/image.png alt=image.png></p><h3 id=슈퍼-타입-서브타입-논리-모델을-실제-물리-모델로-구현하는-방법>슈퍼 타입 서브타입 논리 모델을 실제 물리 모델로 구현하는 방법<a hidden class=anchor aria-hidden=true href=#슈퍼-타입-서브타입-논리-모델을-실제-물리-모델로-구현하는-방법>#</a></h3><ul><li>각각 테이블로 변환 → 조인 전략</li><li>통합 테이블로 변환 → 단일 테이블 전략</li><li>서브타입 테이블로 변환 → 구현 클래스마다 테이블 전략</li></ul><h3 id=주요-어노테이션>주요 어노테이션<a hidden class=anchor aria-hidden=true href=#주요-어노테이션>#</a></h3><ul><li>@Inheritance(<a href="http://strategy=inheritancetype.xxx/">strategy=InheritanceType.XXX</a>)<ul><li><strong>JOINED</strong>: 조인 전략</li><li><strong>SINGLE_TABLE</strong>: 단일 테이블 전략</li><li><strong>TABLE_PER_CLASS</strong>: 구현 클래스마다 테이블 전략</li></ul></li><li>@DiscriminatorColumn(name=“DTYPE”)</li><li>@DiscriminatorValue(“XXX”)
자식 클래스의 DTYPE 이름을 변경할때 사용한다.기본값은 엔티티 명이다.</li></ul><h3 id=조인-전략>조인 전략<a hidden class=anchor aria-hidden=true href=#조인-전략>#</a></h3><p><img loading=lazy src=images/image%201.png alt=image.png></p><blockquote><p><details><summary markdown=span><strong>코드 간략화</strong></summary><p>ITEM 엔티티</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InheritanceType</span><span class=p>.</span><span class=na>JOINED</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorColumn</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>ALBUM 엔티티</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DiscriminatorValue</span><span class=p>(</span><span class=s>&#34;A&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>//DB의 DTYPE에 저장되는 이름 바꾸기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Album</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>artist</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>MOVIE 엔티티</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Movie</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>director</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>actor</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>BOOK엔티티</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Book</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>author</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>isbn</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div></details></p></blockquote><p>ITEM의 name, price가 중복이 안되고 ALBUM, MOVIE, BOOK이 각가 다른 데이터들이 있는 방식으로 DB를 잘 정규화한 모델링이고 JPA와 가장 유사한 모델이다.</p><p><strong>장점</strong></p><ul><li>테이블 정규화</li><li>외래 키 참조 무결성 제약 조건 활용가능</li><li>저장공간 효율화</li></ul><p><strong>단점</strong></p><ul><li>조회시 조인을 많이 사용, 성능 저하</li><li>조회 쿼리가 복잡함</li><li>데이터 저장시 INSERT SQL 2번 호출</li></ul><h3 id=단일-테이블-전략>단일 테이블 전략<a hidden class=anchor aria-hidden=true href=#단일-테이블-전략>#</a></h3><p><img loading=lazy src=images/image%202.png alt=image.png></p><blockquote><p><details><summary markdown=span><strong>코드 간략화</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div></details></p></blockquote><p>@Inheritance(strategy = InheritanceType.SINGLE_TABLE)로 변경해주면 된다.
단일 테이블 전략은 ALBUM, MOVIE, BOOK 인지 알기 위해서 @DiscriminatorColumn이 필수 이기때문에 @DiscriminatorColumn적지 않아도 생성된다.</p><p><strong>장점</strong></p><ul><li>조인이 필요 없으므로 일반적으로 조회 성능이 빠름</li><li>조회 쿼리가 단순함</li></ul><p><strong>단점</strong></p><ul><li>자식 엔티티가 매핑한 컬럼은 모두 null 허용</li><li>단일 테이블에 모든 것을 저장하므로 테이블이 커질 수 있다. 상황에 따라서 조회 성능이 오히려 느려질 수 있다.</li></ul><h3 id=구현-클래스-마다-테이블-전략>구현 클래스 마다 테이블 전략<a hidden class=anchor aria-hidden=true href=#구현-클래스-마다-테이블-전략>#</a></h3><p><img loading=lazy src=images/image%203.png alt=image.png></p><blockquote><p><details><summary markdown=span><strong>코드 간략화</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>abstract</span><span class=w> </span><span class=kd>class</span> <span class=nc>Item</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div></details></p></blockquote><p>Item 클래스를 abstract로 변경하고 @Inheritance(strategy = InheritanceType.SINGLE_TABLE)로 변경해주면 된다.</p><p><strong>이 전략은 데이터베이스 설계자와 ORM 전문가 둘 다 추천X</strong></p><p><strong>장점</strong></p><ul><li>서브 타입을 명확하게 구분해서 처리할 때 효과적</li><li>not null 제약조건 사용 가능</li></ul><p><strong>단점</strong></p><ul><li>여러 자식 테이블을 함계 조회할 때 성능이 느림(UNION SQL 필요)</li><li>자식 테이블을 통합해서 쿼리하기 어려움</li></ul><h3 id=전략-선택>전략 선택<a hidden class=anchor aria-hidden=true href=#전략-선택>#</a></h3><p>기본적으로는 조인전략을 가지고 가는데 조인전략의 장단점이랑 단일 테이블 전략의 장단점 두가지를 가지고 뭘할지 결정하면된다.</p><hr><h2 id=mappedsuperclass>@MappedSuperclass<a hidden class=anchor aria-hidden=true href=#mappedsuperclass>#</a></h2><ul><li>공통 매핑 정보가 필요할 때 사용(id, name)</li></ul><p><img loading=lazy src=images/image%204.png alt=image.png></p><blockquote><p><details><summary markdown=span><strong>코드 간략화</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@MappedSuperClass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BaseEntity</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>....</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>@MapedSuperClass 필요</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Member</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>BaseEntity</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>BaseEntity 상속</p></details></p></blockquote><p>DB는 Member와 Seller를 따로 사용하지만, 객체 입장에서 Member와 Seller의 id, name의 속성만 상속 받고 싶을때 사용한다.
예를 들어서 모든 테이블에 마지막으로 수정한 사람 이름과 날짜가 필요한 상황에서 공통으로 필요하기때문에 이같은 상황에서 사용 가능하다.</p><ul><li>상속관계 매핑x</li><li>엔티티X, 테이블과 매핑X</li><li>부모 클래스를 상속 받는 <strong>자식 클래스에 매핑 정보만 제공</strong></li><li>조회, 검색 불가(<strong>em.find(BaseEntity) 불가</strong>)</li><li>테이블과 관계 없고, 단순히 엔티티가 공통으로 사용하는 매핑 정보를 모으는 역할</li><li>주로 등록일, 수정일, 등록자, 수정자 같은 전체 엔티티에서 공통으로 적용하는 정보를 모을 때 사용</li><li>참고: @Entity 클래스는 엔티티나 @MappedSuperclass로 지
정한 클래스만 상속 가능</li></ul><hr><h2 id=실전-예제---4-상속관계-매핑>실전 예제 - 4. 상속관계 매핑<a hidden class=anchor aria-hidden=true href=#실전-예제---4-상속관계-매핑>#</a></h2><blockquote><p>실전 예제의 코드를 확인하고 싶으면 김영한님의 인프런 강의 <a href=https://www.inflearn.com/course/ORM-JPA-Basic>자바 ORM 표준 JPA 프로그래밍 - 기본편</a>에서 확인 하실수 있습니다.</p></blockquote><h3 id=요구사항-추가>요구사항 추가<a hidden class=anchor aria-hidden=true href=#요구사항-추가>#</a></h3><ul><li>상품의 종류는 음반, 도서, 영화가 있고 이후 더 확장될 수 있다.</li><li>모든 데이터는 등록일과 수정일이 필수다.</li></ul><h3 id=도메인-모델>도메인 모델<a hidden class=anchor aria-hidden=true href=#도메인-모델>#</a></h3><p><img loading=lazy src=images/image%205.png alt=image.png></p><h3 id=도메인-모델-상세>도메인 모델 상세<a hidden class=anchor aria-hidden=true href=#도메인-모델-상세>#</a></h3><p><img loading=lazy src=images/image%206.png alt=image.png></p><h3 id=테이블-설계>테이블 설계<a hidden class=anchor aria-hidden=true href=#테이블-설계>#</a></h3><p><img loading=lazy src=images/image%207.png alt=image.png></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://yosong6729.github.io/tags/jpa/>JPA</a></li></ul><nav class=paginav><a class=next href=https://yosong6729.github.io/post/%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/><span class=title>Next »</span><br><span>[자바 ORM 표준 JPA 프로그래밍 - 기본편] 다양한 연관관계 매핑</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yosong6729.github.io/>Yosong6729 Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>