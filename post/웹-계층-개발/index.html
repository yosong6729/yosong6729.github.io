<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>웹 계층 개발 | Yosong6729 Blog</title>
<meta name=keywords content="spring boot,JPA"><meta name=description content='해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
홈 화면과 레이아웃 홈 컨트롤러 등록 @Slf4j @Controller public class HomeController { @RequestMapping("/") public String home() { log.info("home controller"); return "home"; } } 타임리프 템플릿 등록 home.html <!DOCTYPE HTML> <html xmlns:th="http://www.thymeleaf.org"> <head th:replace="fragments/header :: header"> <title>Hello</title> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> </head> <body> <div class="container"> <div th:replace="fragments/bodyHeader :: bodyHeader" /> <div class="jumbotron"> <h1>HELLO SHOP</h1> <p class="lead">회원 기능</p> <p> <a class="btn btn-lg btn-secondary" href="/members/new">회원 가입</a> <a class="btn btn-lg btn-secondary" href="/members">회원 목록</a> </p> <p class="lead">상품 기능</p> <p> <a class="btn btn-lg btn-dark" href="/items/new">상품 등록</a> <a class="btn btn-lg btn-dark" href="/items">상품 목록</a> </p> <p class="lead">주문 기능</p> <p> <a class="btn btn-lg btn-info" href="/order">상품 주문</a> <a class="btn btn-lg btn-info" href="/orders">주문 내역</a> </p> </div> <div th:replace="fragments/footer :: footer" /> </div> <!'><meta name=author content="yosong6729"><link rel=canonical href=https://yosong6729.github.io/post/%EC%9B%B9-%EA%B3%84%EC%B8%B5-%EA%B0%9C%EB%B0%9C/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yosong6729.github.io/post/%EC%9B%B9-%EA%B3%84%EC%B8%B5-%EA%B0%9C%EB%B0%9C/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="웹 계층 개발"><meta property="og:description" content='해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
홈 화면과 레이아웃 홈 컨트롤러 등록 @Slf4j @Controller public class HomeController { @RequestMapping("/") public String home() { log.info("home controller"); return "home"; } } 타임리프 템플릿 등록 home.html <!DOCTYPE HTML> <html xmlns:th="http://www.thymeleaf.org"> <head th:replace="fragments/header :: header"> <title>Hello</title> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> </head> <body> <div class="container"> <div th:replace="fragments/bodyHeader :: bodyHeader" /> <div class="jumbotron"> <h1>HELLO SHOP</h1> <p class="lead">회원 기능</p> <p> <a class="btn btn-lg btn-secondary" href="/members/new">회원 가입</a> <a class="btn btn-lg btn-secondary" href="/members">회원 목록</a> </p> <p class="lead">상품 기능</p> <p> <a class="btn btn-lg btn-dark" href="/items/new">상품 등록</a> <a class="btn btn-lg btn-dark" href="/items">상품 목록</a> </p> <p class="lead">주문 기능</p> <p> <a class="btn btn-lg btn-info" href="/order">상품 주문</a> <a class="btn btn-lg btn-info" href="/orders">주문 내역</a> </p> </div> <div th:replace="fragments/footer :: footer" /> </div> <!'><meta property="og:type" content="article"><meta property="og:url" content="https://yosong6729.github.io/post/%EC%9B%B9-%EA%B3%84%EC%B8%B5-%EA%B0%9C%EB%B0%9C/"><meta property="og:image" content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-09-22T18:17:58+09:00"><meta property="article:modified_time" content="2024-09-22T18:17:58+09:00"><meta property="og:site_name" content="Yosong6729 Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="웹 계층 개발"><meta name=twitter:description content='해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.
홈 화면과 레이아웃 홈 컨트롤러 등록 @Slf4j @Controller public class HomeController { @RequestMapping("/") public String home() { log.info("home controller"); return "home"; } } 타임리프 템플릿 등록 home.html <!DOCTYPE HTML> <html xmlns:th="http://www.thymeleaf.org"> <head th:replace="fragments/header :: header"> <title>Hello</title> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> </head> <body> <div class="container"> <div th:replace="fragments/bodyHeader :: bodyHeader" /> <div class="jumbotron"> <h1>HELLO SHOP</h1> <p class="lead">회원 기능</p> <p> <a class="btn btn-lg btn-secondary" href="/members/new">회원 가입</a> <a class="btn btn-lg btn-secondary" href="/members">회원 목록</a> </p> <p class="lead">상품 기능</p> <p> <a class="btn btn-lg btn-dark" href="/items/new">상품 등록</a> <a class="btn btn-lg btn-dark" href="/items">상품 목록</a> </p> <p class="lead">주문 기능</p> <p> <a class="btn btn-lg btn-info" href="/order">상품 주문</a> <a class="btn btn-lg btn-info" href="/orders">주문 내역</a> </p> </div> <div th:replace="fragments/footer :: footer" /> </div> <!'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yosong6729.github.io/post/"},{"@type":"ListItem","position":2,"name":"웹 계층 개발","item":"https://yosong6729.github.io/post/%EC%9B%B9-%EA%B3%84%EC%B8%B5-%EA%B0%9C%EB%B0%9C/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"웹 계층 개발","name":"웹 계층 개발","description":"해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n홈 화면과 레이아웃 홈 컨트롤러 등록 @Slf4j @Controller public class HomeController { @RequestMapping(\u0026#34;/\u0026#34;) public String home() { log.info(\u0026#34;home controller\u0026#34;); return \u0026#34;home\u0026#34;; } } 타임리프 템플릿 등록 home.html \u0026lt;!DOCTYPE HTML\u0026gt; \u0026lt;html xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head th:replace=\u0026#34;fragments/header :: header\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Hello\u0026lt;/title\u0026gt; \u0026lt;meta http-equiv=\u0026#34;Content-Type\u0026#34; content=\u0026#34;text/html; charset=UTF-8\u0026#34; /\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div th:replace=\u0026#34;fragments/bodyHeader :: bodyHeader\u0026#34; /\u0026gt; \u0026lt;div class=\u0026#34;jumbotron\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;HELLO SHOP\u0026lt;/h1\u0026gt; \u0026lt;p class=\u0026#34;lead\u0026#34;\u0026gt;회원 기능\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-secondary\u0026#34; href=\u0026#34;/members/new\u0026#34;\u0026gt;회원 가입\u0026lt;/a\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-secondary\u0026#34; href=\u0026#34;/members\u0026#34;\u0026gt;회원 목록\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;lead\u0026#34;\u0026gt;상품 기능\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-dark\u0026#34; href=\u0026#34;/items/new\u0026#34;\u0026gt;상품 등록\u0026lt;/a\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-dark\u0026#34; href=\u0026#34;/items\u0026#34;\u0026gt;상품 목록\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;lead\u0026#34;\u0026gt;주문 기능\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-info\u0026#34; href=\u0026#34;/order\u0026#34;\u0026gt;상품 주문\u0026lt;/a\u0026gt; \u0026lt;a class=\u0026#34;btn btn-lg btn-info\u0026#34; href=\u0026#34;/orders\u0026#34;\u0026gt;주문 내역\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div th:replace=\u0026#34;fragments/footer :: footer\u0026#34; /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!","keywords":["spring boot","JPA"],"articleBody":" 해당 글은 김영한님의 인프런 강의 스프링부트와 JPA활용1 - 웹 어플리케이션 개발을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.\n홈 화면과 레이아웃 홈 컨트롤러 등록 @Slf4j @Controller public class HomeController { @RequestMapping(\"/\") public String home() { log.info(\"home controller\"); return \"home\"; } } 타임리프 템플릿 등록 home.html \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\"\u003e \u003ctitle\u003eHello\u003c/title\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\" /\u003e \u003cdiv class=\"jumbotron\"\u003e \u003ch1\u003eHELLO SHOP\u003c/h1\u003e \u003cp class=\"lead\"\u003e회원 기능\u003c/p\u003e \u003cp\u003e \u003ca class=\"btn btn-lg btn-secondary\" href=\"/members/new\"\u003e회원 가입\u003c/a\u003e \u003ca class=\"btn btn-lg btn-secondary\" href=\"/members\"\u003e회원 목록\u003c/a\u003e \u003c/p\u003e \u003cp class=\"lead\"\u003e상품 기능\u003c/p\u003e \u003cp\u003e \u003ca class=\"btn btn-lg btn-dark\" href=\"/items/new\"\u003e상품 등록\u003c/a\u003e \u003ca class=\"btn btn-lg btn-dark\" href=\"/items\"\u003e상품 목록\u003c/a\u003e \u003c/p\u003e \u003cp class=\"lead\"\u003e주문 기능\u003c/p\u003e \u003cp\u003e \u003ca class=\"btn btn-lg btn-info\" href=\"/order\"\u003e상품 주문\u003c/a\u003e \u003ca class=\"btn btn-lg btn-info\" href=\"/orders\"\u003e주문 내역\u003c/a\u003e \u003c/p\u003e \u003c/div\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 백엔드 코드가 중점이기때문에 header.html, bodyHeader.html, footer.html와 bootstrap 적용은 넘어가도록 하겠다.\n참고: Hierarchical-style layouts 예제에서는 뷰 템플릿을 최대한 간단하게 설명하려고, header, footer같은 템플릿 파일을 반복해서 포함한다. 다음 링크의 Hierarchical-style layouts을 참고하면 이런 부분도 중복을 제거할 수 있다. https://www.thymeleaf.org/doc/articles/layouts.html\n참고: 뷰 템플릿 변경사항을 서버 재시작 없이 즉시 반영하기\nspring-boot-devtools 추가 html 파일 build-\u003e Recompile 회원 등록 폼 객체를 사용해서 화면 계층과 서비스 계층을 분리한다.\n회원 등록 폼 객체\n@Getter @Setter public class MemberForm { @NotEmpty(message = \"회원 이름은 필수 입니다.\") private String name; private String city; private String street; private String zipcode; } 가단한 예제를 위해 검증하는 에노테이션은 한개만 한다.\n회원 등록 컨트롤러\n@Controller @RequiredArgsConstructor public class MemberController { private final MemberService memberService; @GetMapping(\"/members/new\") public String createForm(Model model) { model.addAttribute(\"memberForm\", new MemberForm()); return \"members/createMemberForm\"; } @PostMapping(\"/members/new\") public String create(@Valid MemberForm form, BindingResult result) { if (result.hasErrors()) { return \"members/createMemberForm\"; } Address address = new Address(form.getCity(), form.getStreet(), form.getZipcode()); Member member = new Member(); member.setName(form.getName()); member.setAddress(address); memberService.join(member); return \"redirect:/\"; } } @valid로 인해 에러가 생기면 result에 담기면서 result에 담긴 정보를 가지고 createMemberForm.html로 이동한다. 그리고 에러가 발생해도 form데이터도 다시 createMemberForm에 가져가기때문에 웹에 입력했던 데이터 값은 그대로 나온다\n회원 등록 폼 화면 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cstyle\u003e .fieldError { border-color: #bd2130; } \u003c/style\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cform role=\"form\" action=\"/members/new\" th:object=\"${memberForm}\" method=\"post\"\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"name\"\u003e이름\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{name}\" class=\"form-control\" placeholder=\"이름을 입력하세요\" th:class=\"${#fields.hasErrors('name')}? 'form-control fieldError' : 'form-control'\"\u003e \u003cp th:if=\"${#fields.hasErrors('name')}\" th:errors=\"*{name}\"\u003eIncorrect date\u003c/p\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"city\"\u003e도시\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{city}\" class=\"form-control\" placeholder=\"도시를 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"street\"\u003e거리\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{street}\" class=\"form-control\" placeholder=\"거리를 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"zipcode\"\u003e우편번호\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{zipcode}\" class=\"form-control\" placeholder=\"우편번호를 입력하세요\"\u003e \u003c/div\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary\"\u003eSubmit\u003c/button\u003e \u003c/form\u003e \u003cbr/\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 회원 목록 조회 회원 목록 컨트롤러 추가\n@Controller @RequiredArgsConstructor public class MemberController { //... //추가 @GetMapping(\"/members\") public String list(Model model) { List\u003cMember\u003e members = memberService.findMembers(); model.addAttribute(\"members\", members); return \"members/memberList\"; } } 회원 목록 뷰 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\" /\u003e \u003cdiv\u003e \u003ctable class=\"table table-striped\"\u003e \u003cthead\u003e \u003ctr\u003e \u003cth\u003e#\u003c/th\u003e \u003cth\u003e이름\u003c/th\u003e \u003cth\u003e도시\u003c/th\u003e \u003cth\u003e주소\u003c/th\u003e \u003cth\u003e우편번호\u003c/th\u003e \u003c/tr\u003e \u003c/thead\u003e \u003ctbody\u003e \u003ctr th:each=\"member : ${members}\"\u003e \u003ctd th:text=\"${member.id}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${member.name}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${member.address?.city}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${member.address?.street}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${member.address?.zipcode}\"\u003e\u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c/div\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 타임리프에서 ?를 사용하면 null을 무시한다.\n상품 등록 상품 등록 폼\n@Getter @Setter public class BookForm { private Long id; private String name; private int price; private int stockQuantity; private String author; private String isbn; } 상품 등록 컨트롤러\n@Controller @RequiredArgsConstructor public class ItemController { private final ItemService itemService; @GetMapping(\"/items/new\") public String createForm(Model model) { model.addAttribute(\"form\", new BookForm()); return \"items/createItemForm\"; } @PostMapping(\"/items/new\") public String create(BookForm form) { Book book = new Book(); book.setName(form.getName()); book.setPrice(form.getPrice()); book.setStockQuantity(form.getStockQuantity()); book.setAuthor(form.getAuthor()); book.setIsbn(form.getIsbn()); itemService.saveItem(book); return \"redirect:/\"; } } create메서드에서 Book을 set으로 BookForm의 값들을 하나씩 대입하는것보다 엔티티에 생성 메서드를 만드는게 좋다.\n상품 등록 뷰 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cform th:action=\"@{/items/new}\" th:object=\"${form}\" method=\"post\"\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"name\"\u003e상품명\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{name}\" class=\"form-control\" placeholder=\"이름을 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"price\"\u003e가격\u003c/label\u003e \u003cinput type=\"number\" th:field=\"*{price}\" class=\"form-control\" placeholder=\"가격을 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"stockQuantity\"\u003e수량\u003c/label\u003e \u003cinput type=\"number\" th:field=\"*{stockQuantity}\" class=\"form-control\" placeholder=\"수량을 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"author\"\u003e저자\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{author}\" class=\"form-control\" placeholder=\"저자를 입력하세요\"\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"isbn\"\u003eISBN\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{isbn}\" class=\"form-control\" placeholder=\"ISBN을 입력하세요\"\u003e \u003c/div\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary\"\u003eSubmit\u003c/button\u003e \u003c/form\u003e \u003cbr/\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 상품 등록 폼에서 데이터를 입력하고 Submit 버튼을 클릭하면 /items/new를 POST 방식으로 요청 상품 저장이 끝나면 상품 목록 화면(redirect:/items)으로 리다이렉트 상품 목록 상품 목록 컨트롤러\n@Controller @RequiredArgsConstructor public class ItemController { private final ItemService itemService; //... @GetMapping(\"/items\") public String list(Model model) { List\u003cItem\u003e items = itemService.findItems(); model.addAttribute(\"items\", items); return \"items/itemList\"; } } 상품 목록 뷰 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cdiv\u003e \u003ctable class=\"table table-striped\"\u003e \u003cthead\u003e \u003ctr\u003e \u003cth\u003e#\u003c/th\u003e \u003cth\u003e상품명\u003c/th\u003e \u003cth\u003e가격\u003c/th\u003e \u003cth\u003e재고수량\u003c/th\u003e \u003cth\u003e\u003c/th\u003e \u003c/tr\u003e \u003c/thead\u003e \u003ctbody\u003e \u003ctr th:each=\"item : ${items}\"\u003e \u003ctd th:text=\"${item.id}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.name}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.price}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.stockQuantity}\"\u003e\u003c/td\u003e \u003ctd\u003e \u003ca href=\"#\" th:href=\"@{/items/{id}/edit (id=${item.id})}\" class=\"btn btn-primary\" role=\"button\"\u003e수정\u003c/a\u003e \u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c/div\u003e \u003cdiv th:replace=\"fragments/footer :: footer\"/\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 상품 수정 상품 수정과 관련된 컨트롤러 코드\n@Controller @RequiredArgsConstructor public class ItemController { //상품 수정 폼 추가 @GetMapping(\"/items/{itemId}/edit\") public String updateItemForm(@PathVariable(\"itemId\") Long itemId, Model model) { Book item = (Book) itemService.findOne(itemId); BookForm form = new BookForm(); form.setId(item.getId()); form.setName(item.getName()); form.setPrice(item.getPrice()); form.setStockQuantity(item.getStockQuantity()); form.setAuthor(item.getAuthor()); form.setIsbn(item.getIsbn()); model.addAttribute(\"form\", form); return \"items/updateItemForm\"; } @PostMapping(\"/items/{itemId}/edit\") public String updateItem(@PathVariable Long itemId, @ModelAttribute(\"form\") BookForm form) { Book book = new Book(); book.setId(form.getId()); book.setName(form.getName()); book.setPrice(form.getPrice()); book.setStockQuantity(form.getStockQuantity()); book.setAuthor(form.getAuthor()); book.setIsbn(form.getIsbn()); itemService.saveItem(book); return \"redirect:/items\"; } } 상품 수정 폼 화면 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cform th:object=\"${form}\" method=\"post\"\u003e \u003cinput type=\"hidden\" th:field=\"*{id}\" /\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"name\"\u003e상품명\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{name}\" class=\"form-control\" placeholder=\"이름을 입력하세요\" /\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"price\"\u003e가격\u003c/label\u003e \u003cinput type=\"number\" th:field=\"*{price}\" class=\"form-control\" placeholder=\"가격을 입력하세요\" /\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"stockQuantity\"\u003e수량\u003c/label\u003e \u003cinput type=\"number\" th:field=\"*{stockQuantity}\" class=\"form-control\" placeholder=\"수량을 입력하세요\" /\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"author\"\u003e저자\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{author}\" class=\"form-control\" placeholder=\"저자를 입력하세요\" /\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel th:for=\"isbn\"\u003eISBN\u003c/label\u003e \u003cinput type=\"text\" th:field=\"*{isbn}\" class=\"form-control\" placeholder=\"ISBN을 입력하세요\" /\u003e \u003c/div\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary\"\u003eSubmit\u003c/button\u003e \u003c/form\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 상품 수정 폼 이동\n수정 버튼을 선택하면 /items/{itemId}/edit URL을 GET 방식으로 요청 그 결과로 updateItemForm() 메서드를 실행하는데 이 메서드는 itemService.fondOne(itemId)를 호출해서 수정할 상품을 조회 조회 결과를 모델 객체에 담아서 뷰(items/updateItemForm)에 전달 상품 수정 실행\n상품 수정 폼에서 정보를 수정하고 Submit 버튼을 선택 /items/{itemId}/edit URL을 POST방식으로 요청하고 updateItem() 메서드를 실행 이때 컨트롤러에 파라미터로 넘어온 Item 엔티티 인스턴스는 현재 준영속 상태다. 따라서 영속성 컨텍스트의 지원을 받을 수 없고 데이터를 수정해도 변경 감지 기능은 동작X 변경 감지와 병합(merge) 준영속 엔티티\n영속성 컨텍스트가 더는 관리하지 않는 엔티티를 말한다. (여기서는itemService.saveItem(book)에서 수정을 시도하는 Book 객체다.) Book 객체는 이미 DB에 한번 저장되어서 식별자가 존재한다. 이렇게 임의로 만들어낸 엔티티도 기존 식별자를 가지고 있으면 준영속 엔티티로 볼 수있다.\n준영속 엔티티를 수정하는 2가지 방법\n변경 감지 기능 사용 병합(merge)사용 변경 감지 기능 사용 @Transactional void update(Item itemParam) { //itemParam: 파리미터로 넘어온 준영속 상태의 엔티티 Item findItem = em.find(Item.class, itemParam.getId()); //같은 엔티티를 조회한다. findItem.setPrice(itemParam.getPrice()); //데이터를 수정한다. } 영속성 컨텍스트에서 엔티티를 다시 조회한 후에 데이터를 수정하는 방법읻. 트랜잭션 안에서 엔티티를 다시 조회, 변경 할 값 선택후 트랜잭션 커밋 시점에 변경감지가 동작해서 데이터베이스에 UPDATE SQL 실행한다.\n병합사용 병합은 준영속 상태의 엔티티를 영속 상태로 변경할 때 사용하는 기능이다.\n@Transactional void update(Item itemParam) { //itemParam: 파리미터로 넘어온 준영속 상태의 엔티티 Item mergeItem = em.merge(itemParam); } 병합: 기존에 있는 엔티티\n병합시 동작 방식을 간단히 정리\n준영속 엔티티의 식별자 값으로 영속 엔티티를 조회한다. 영속 엔티티의 값을 준영속 엔티티의 값으로 모두 교체한다.(병합한다.) 트랜잭션 커밋 시점에 변경 감지 기능이 동작해서 데이터베이스에 UPDATE SQL이 실행 주의: 변경 감지 기능을 사용하면 원하는 속성만 선택해서 변경할 수 있지만, 병합을 사용하면 모든 속성이 변경된다. 병합시 값이 없으면 null로 업데이트 할 위험도 있다. (병합은 모든 필드를 교체한다.)\n상품 리포지토리의 저장 메서드 분석 ItemRepository @Repository @RequiredArgsConstructor public class ItemRepository { private final EntityManager em; public void save(Item item) { if (item.getId() == null) { em.persist(item); } else { em.merge(item); } } //... } save() 메서드는 식별자 값이 없으면(null) 새로운 엔티티로 판단해서 영속화(persist)하고 식별자가 있으면 병합(merge) 지금처럼 준영속 상태인 상품 엔티티를 수정할 때는 id값이 있으므로 병합 수행 실무에서는 보통 업데이트 기능이 매우 제한적이다. 그런데 병합은 모든 필드를 변경해버리고, 데이터가 없으면 null 로 업데이트 해버린다. 병합을 사용하면서 이 문제를 해결하려면, 변경 폼 화면에서 모든 데이터를 항 상 유지해야 한다. 실무에서는 보통 변경가능한 데이터만 노출하기 때문에, 병합을 사용하는 것이 오히려 번거롭다.\n그럼 변경감지와 병합중 어떤 것을 써야할까?\n가장 좋은 해결방법은 엔티티를 변경할때는 항상 변경감지를 상용하는 것이다.\n컨트롤러에서 어설프게 엔티티를 생성 X 트랜잭션이 있는 서비스 계층에 식별자(id)와 변경할 데이터를 명확하게 전달(파라미터 or dto) 트랜잭션이 있는 서비스 계층에서 영속 상태의 엔티티를 조회하고, 엔티티의 데이터를 직접 변경 트랜잭션 커밋 시점에 변경 감지가 실행됩니다. @Controller @RequiredArgsConstructor public class ItemController { private final ItemService itemService; //.... @PostMapping(\"/items/{itemId}/edit\") public String updateItem(@PathVariable Long itemId, @ModelAttribute(\"form\") BookForm form) { itemService.updateItem(itemId, form.getName(), form.getPrice(), form.getStockQuantity()); return \"redirect:/items\"; } } @Service @Transactional(readOnly = true) @RequiredArgsConstructor public class ItemService { private final ItemRepository itemRepository; //... @Transactional public void updateItem(Long itemId, String name, int price, int stockQuantity) { Item finditem = itemRepository.findOne(itemId); finditem.setName(name); finditem.setPrice(price); finditem.setStockQuantity(stockQuantity); } } 상품 주문 상품 주문 컨트롤러\nController @RequiredArgsConstructor public class OrderController { private final OrderService orderService; private final MemberService memberService; private final ItemService itemService; @GetMapping(\"/order\") public String creatForm(Model model) { List\u003cMember\u003e members = memberService.findMembers(); List\u003cItem\u003e items = itemService.findItems(); model.addAttribute(\"members\", members); model.addAttribute(\"items\", items); return \"order/orderForm\"; } @PostMapping(\"/order\") public String order(@RequestParam(\"memberId\") Long memberId, @RequestParam(\"itemId\") Long itemId, @RequestParam(\"count\") int count) { orderService.order(memberId, itemId, count); return \"redirect:/orders\"; } } 주문 폼 이동\n메인 화면에서 상품 주문을 선택하면 /order를 GET방식으로 호출 OrderController의 createForm() 메서드 주문 화면에는 주문할 고객정보와 상품 정보가 필요하므로 model객체에 담아서 뷰에 넘겨줌 주문 실행\n주문할 회원과 상품 그리고 수량을 선택해서 Submit 버튼을 누르면 /order URL을 POST 방식으로 호출\n컨트롤러의 order() 메서드 실행\n이 메서드는 고객 식별자(memberId), 주문할 상품 식별자(itemId), 수량(count)정보를 받아서 주문 서비스에 주문을 요청\n주문이 끝나면 상품 주문 내역이 있는 /orders URL로 리다이렉트\n상품 주문 폼\n\u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\" /\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cform role=\"form\" action=\"/order\" method=\"post\"\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel for=\"member\"\u003e주문회원\u003c/label\u003e \u003cselect name=\"memberId\" id=\"member\" class=\"form-control\"\u003e \u003coption value=\"\"\u003e회원선택\u003c/option\u003e \u003coption th:each=\"member : ${members}\" th:value=\"${member.id}\" th:text=\"${member.name}\" /\u003e \u003c/select\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel for=\"item\"\u003e상품명\u003c/label\u003e \u003cselect name=\"itemId\" id=\"item\" class=\"form-control\"\u003e \u003coption value=\"\"\u003e상품선택\u003c/option\u003e \u003coption th:each=\"item : ${items}\" th:value=\"${item.id}\" th:text=\"${item.name}\" /\u003e \u003c/select\u003e \u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003clabel for=\"count\"\u003e주문수량\u003c/label\u003e \u003cinput type=\"number\" name=\"count\" class=\"form-control\" id=\"count\" placeholder=\"주문 수량을 입력하세요\"\u003e \u003c/div\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary\"\u003eSubmit\u003c/button\u003e \u003c/form\u003e \u003cbr/\u003e \u003cdiv th:replace=\"fragments/footer :: footer\" /\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 주문 목록 검색, 취소 주문 목록\n검색 컨트롤러\n@Controller @RequiredArgsConstructor public class OrderController { private final OrderService orderService; private final MemberService memberService; private final ItemService itemService; //... @GetMapping(\"/orders\") public String orderList(@ModelAttribute(\"orderSearch\") OrderSearch orderSearch, Model model) { List\u003cOrder\u003e orders = orderService.findOrders(orderSearch); model.addAttribute(\"orders\", orders); return \"order/orderList\"; } } 주문 목록 검색 화면 \u003c!DOCTYPE HTML\u003e \u003chtml xmlns:th=\"http://www.thymeleaf.org\"\u003e \u003chead th:replace=\"fragments/header :: header\"/\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e \u003cdiv th:replace=\"fragments/bodyHeader :: bodyHeader\"/\u003e \u003cdiv\u003e \u003cdiv\u003e \u003cform th:object=\"${orderSearch}\" class=\"form-inline\"\u003e \u003cdiv class=\"form-group mb-2\"\u003e \u003cinput type=\"text\" th:field=\"*{memberName}\" class=\"form-control\" placeholder=\"회원명\"/\u003e \u003c/div\u003e \u003cdiv class=\"form-group mx-sm-1 mb-2\"\u003e \u003cselect th:field=\"*{orderStatus}\" class=\"form-control\"\u003e \u003coption value=\"\"\u003e주문상태\u003c/option\u003e \u003coption th:each=\"status : ${T(jpabook.jpashop.domain.OrderStatus).values()}\" th:value=\"${status}\" th:text=\"${status}\"\u003eoption \u003c/option\u003e \u003c/select\u003e \u003c/div\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary mb-2\"\u003e검색\u003c/button\u003e \u003c/form\u003e \u003c/div\u003e \u003ctable class=\"table table-striped\"\u003e \u003cthead\u003e \u003ctr\u003e \u003cth\u003e#\u003c/th\u003e \u003cth\u003e회원명\u003c/th\u003e \u003cth\u003e대표상품 이름\u003c/th\u003e \u003cth\u003e대표상품 주문가격\u003c/th\u003e \u003cth\u003e대표상품 주문수량\u003c/th\u003e \u003cth\u003e상태\u003c/th\u003e \u003cth\u003e일시\u003c/th\u003e \u003cth\u003e\u003c/th\u003e \u003c/tr\u003e \u003c/thead\u003e \u003ctbody\u003e \u003ctr th:each=\"item : ${orders}\"\u003e \u003ctd th:text=\"${item.id}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.member.name}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.orderItems[0].item.name}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.orderItems[0].orderPrice}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.orderItems[0].count}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.status}\"\u003e\u003c/td\u003e \u003ctd th:text=\"${item.orderDate}\"\u003e\u003c/td\u003e \u003ctd\u003e \u003ca th:if=\"${item.status.name() == 'ORDER'}\" href=\"#\" th:href=\"'javascript:cancel('+${item.id}+')'\" class=\"btn btn-danger\"\u003eCANCEL\u003c/a\u003e \u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c/div\u003e \u003cdiv th:replace=\"fragments/footer :: footer\"/\u003e \u003c/div\u003e \u003c/body\u003e \u003cscript\u003e function cancel(id) { var form = document.createElement(\"form\"); form.setAttribute(\"method\", \"post\"); form.setAttribute(\"action\", \"/orders/\" + id + \"/cancel\"); document.body.appendChild(form); form.submit(); } \u003c/script\u003e \u003c/html\u003e 주문 취소\n@Controller @RequiredArgsConstructor public class OrderController { private final OrderService orderService; private final MemberService memberService; private final ItemService itemService; @PostMapping(\"/orders/{orderId}/cancel\") public String cancelOrder(@PathVariable(\"orderId\") Long orderId) { orderService.cancelOrder(orderId); return \"redirect:/orders\"; } } ","wordCount":"1920","inLanguage":"en","image":"https://yosong6729.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-09-22T18:17:58+09:00","dateModified":"2024-09-22T18:17:58+09:00","author":{"@type":"Person","name":"yosong6729"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yosong6729.github.io/post/%EC%9B%B9-%EA%B3%84%EC%B8%B5-%EA%B0%9C%EB%B0%9C/"},"publisher":{"@type":"Organization","name":"Yosong6729 Blog","logo":{"@type":"ImageObject","url":"https://yosong6729.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yosong6729.github.io/ accesskey=h title="Yosong6729 블로그 (Alt + H)"><img src=https://yosong6729.github.io/apple-touch-icon.png alt aria-label=logo height=35>Yosong6729 블로그</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yosong6729.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://yosong6729.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yosong6729.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yosong6729.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">웹 계층 개발</h1><div class=post-meta><span title='2024-09-22 18:17:58 +0900 KST'>September 22, 2024</span>&nbsp;·&nbsp;yosong6729&nbsp;|&nbsp;<a href=https://github.com/yosong6729/blog/tree/main/content/post/%ec%9b%b9%20%ea%b3%84%ec%b8%b5%20%ea%b0%9c%eb%b0%9c/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ed%99%88-%ed%99%94%eb%a9%b4%ea%b3%bc-%eb%a0%88%ec%9d%b4%ec%95%84%ec%9b%83 aria-label="홈 화면과 레이아웃">홈 화면과 레이아웃</a><ul><li><a href=#%ed%99%88-%ec%bb%a8%ed%8a%b8%eb%a1%a4%eb%9f%ac-%eb%93%b1%eb%a1%9d aria-label="홈 컨트롤러 등록">홈 컨트롤러 등록</a></li><li><a href=#%ed%83%80%ec%9e%84%eb%a6%ac%ed%94%84-%ed%85%9c%ed%94%8c%eb%a6%bf-%eb%93%b1%eb%a1%9d aria-label="타임리프 템플릿 등록">타임리프 템플릿 등록</a></li></ul></li><li><a href=#%ed%9a%8c%ec%9b%90-%eb%93%b1%eb%a1%9d aria-label="회원 등록">회원 등록</a></li><li><a href=#%ed%9a%8c%ec%9b%90-%eb%aa%a9%eb%a1%9d-%ec%a1%b0%ed%9a%8c aria-label="회원 목록 조회">회원 목록 조회</a></li><li><a href=#%ec%83%81%ed%92%88-%eb%93%b1%eb%a1%9d aria-label="상품 등록">상품 등록</a></li><li><a href=#%ec%83%81%ed%92%88-%eb%aa%a9%eb%a1%9d aria-label="상품 목록">상품 목록</a></li><li><a href=#%ec%83%81%ed%92%88-%ec%88%98%ec%a0%95 aria-label="상품 수정">상품 수정</a></li><li><a href=#%eb%b3%80%ea%b2%bd-%ea%b0%90%ec%a7%80%ec%99%80-%eb%b3%91%ed%95%a9merge aria-label="변경 감지와 병합(merge)">변경 감지와 병합(merge)</a><ul><li><a href=#%eb%b3%80%ea%b2%bd-%ea%b0%90%ec%a7%80-%ea%b8%b0%eb%8a%a5-%ec%82%ac%ec%9a%a9 aria-label="변경 감지 기능 사용">변경 감지 기능 사용</a></li><li><a href=#%eb%b3%91%ed%95%a9%ec%82%ac%ec%9a%a9 aria-label=병합사용>병합사용</a></li><li><a href=#%ec%83%81%ed%92%88-%eb%a6%ac%ed%8f%ac%ec%a7%80%ed%86%a0%eb%a6%ac%ec%9d%98-%ec%a0%80%ec%9e%a5-%eb%a9%94%ec%84%9c%eb%93%9c-%eb%b6%84%ec%84%9d-itemrepository aria-label="상품 리포지토리의 저장 메서드 분석 ItemRepository">상품 리포지토리의 저장 메서드 분석 ItemRepository</a></li></ul></li><li><a href=#%ec%83%81%ed%92%88-%ec%a3%bc%eb%ac%b8 aria-label="상품 주문">상품 주문</a></li><li><a href=#%ec%a3%bc%eb%ac%b8-%eb%aa%a9%eb%a1%9d-%ea%b2%80%ec%83%89-%ec%b7%a8%ec%86%8c aria-label="주문 목록 검색, 취소">주문 목록 검색, 취소</a></li></ul></div></details></div><div class=post-content><blockquote><p>해당 글은 김영한님의 인프런 강의 <a href=https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-JPA-%ED%99%9C%EC%9A%A9-1>스프링부트와 JPA활용1 - 웹 어플리케이션 개발</a>을 듣고 내용을 정리하기 위한 것으로 자세한 설명은 해당 강의를 통해 확인할 수 있습니다.</p></blockquote><hr><h2 id=홈-화면과-레이아웃>홈 화면과 레이아웃<a hidden class=anchor aria-hidden=true href=#홈-화면과-레이아웃>#</a></h2><h3 id=홈-컨트롤러-등록><strong>홈 컨트롤러 등록</strong><a hidden class=anchor aria-hidden=true href=#홈-컨트롤러-등록>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Slf4j</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>HomeController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>home</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;home controller&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;home&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=타임리프-템플릿-등록><strong>타임리프 템플릿 등록</strong><a hidden class=anchor aria-hidden=true href=#타임리프-템플릿-등록>#</a></h3><blockquote><p><details><summary markdown=span><strong>home.html</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span><span class=nx>Hello</span><span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http</span><span class=err>-</span><span class=na>equiv</span><span class=o>=</span><span class=s>&#34;Content-Type&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;text/html; charset=UTF-8&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;jumbotron&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>HELLO</span> <span class=nx>SHOP</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;lead&#34;</span><span class=p>&gt;</span><span class=nx>회원</span> <span class=nx>기능</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-secondary&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/members/new&#34;</span><span class=p>&gt;</span><span class=nx>회원</span> <span class=nx>가입</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-secondary&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/members&#34;</span><span class=p>&gt;</span><span class=nx>회원</span> <span class=nx>목록</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;lead&#34;</span><span class=p>&gt;</span><span class=nx>상품</span> <span class=nx>기능</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-dark&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/items/new&#34;</span><span class=p>&gt;</span><span class=nx>상품</span> <span class=nx>등록</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-dark&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/items&#34;</span><span class=p>&gt;</span><span class=nx>상품</span> <span class=nx>목록</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;lead&#34;</span><span class=p>&gt;</span><span class=nx>주문</span> <span class=nx>기능</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-info&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/order&#34;</span><span class=p>&gt;</span><span class=nx>상품</span> <span class=nx>주문</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-info&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/orders&#34;</span><span class=p>&gt;</span><span class=nx>주문</span> <span class=nx>내역</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><p>백엔드 코드가 중점이기때문에 header.html, bodyHeader.html, footer.html와 bootstrap 적용은 넘어가도록 하겠다.</p><blockquote><p>참고: <strong>Hierarchical-style layouts</strong>
예제에서는 뷰 템플릿을 최대한 간단하게 설명하려고, header, footer같은 템플릿 파일을 반복해서 포함한다. 다음 링크의 Hierarchical-style layouts을 참고하면 이런 부분도 중복을 제거할 수 있다.
<a href=https://www.thymeleaf.org/doc/articles/layouts.html>https://www.thymeleaf.org/doc/articles/layouts.html</a></p></blockquote><blockquote><p>참고: 뷰 템플릿 변경사항을 서버 재시작 없이 즉시 반영하기</p><ol><li>spring-boot-devtools 추가</li><li>html 파일 build-> Recompile</li></ol></blockquote><hr><h2 id=회원-등록>회원 등록<a hidden class=anchor aria-hidden=true href=#회원-등록>#</a></h2><p>폼 객체를 사용해서 화면 계층과 서비스 계층을 분리한다.</p><p><strong>회원 등록 폼 객체</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberForm</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@NotEmpty</span><span class=p>(</span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;회원 이름은 필수 입니다.&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>city</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>street</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>zipcode</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>가단한 예제를 위해 검증하는 에노테이션은 한개만 한다.</p><p><strong>회원 등록 컨트롤러</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberService</span><span class=w> </span><span class=n>memberService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members/new&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>createForm</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;memberForm&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MemberForm</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;members/createMemberForm&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/members/new&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>create</span><span class=p>(</span><span class=nd>@Valid</span><span class=w> </span><span class=n>MemberForm</span><span class=w> </span><span class=n>form</span><span class=p>,</span><span class=w> </span><span class=n>BindingResult</span><span class=w> </span><span class=n>result</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>result</span><span class=p>.</span><span class=na>hasErrors</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=s>&#34;members/createMemberForm&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Address</span><span class=w> </span><span class=n>address</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Address</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getCity</span><span class=p>(),</span><span class=w> </span><span class=n>form</span><span class=p>.</span><span class=na>getStreet</span><span class=p>(),</span><span class=w> </span><span class=n>form</span><span class=p>.</span><span class=na>getZipcode</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Member</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Member</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>member</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getName</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>member</span><span class=p>.</span><span class=na>setAddress</span><span class=p>(</span><span class=n>address</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>memberService</span><span class=p>.</span><span class=na>join</span><span class=p>(</span><span class=n>member</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>@valid로 인해 에러가 생기면 result에 담기면서 result에 담긴 정보를 가지고 createMemberForm.html로 이동한다. 그리고 에러가 발생해도 form데이터도 다시 createMemberForm에 가져가기때문에 웹에 입력했던 데이터 값은 그대로 나온다</p><blockquote><p><details><summary markdown=span><strong>회원 등록 폼 화면</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>fieldError</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>border</span><span class=o>-</span><span class=nx>color</span><span class=o>:</span> <span class=err>#</span><span class=nx>bd2130</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>role</span><span class=o>=</span><span class=s>&#34;form&#34;</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/members/new&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>object</span><span class=o>=</span><span class=s>&#34;${memberForm}&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>&gt;</span><span class=nx>이름</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{name}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;이름을 입력하세요&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>th</span><span class=err>:</span><span class=na>class</span><span class=o>=</span><span class=s>&#34;${#fields.hasErrors(&#39;name&#39;)}? &#39;form-control fieldError&#39; : &#39;form-control&#39;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>p</span> <span class=na>th</span><span class=err>:</span><span class=na>if</span><span class=o>=</span><span class=s>&#34;${#fields.hasErrors(&#39;name&#39;)}&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>errors</span><span class=o>=</span><span class=s>&#34;*{name}&#34;</span><span class=p>&gt;</span><span class=nx>Incorrect</span> <span class=nx>date</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;city&#34;</span><span class=p>&gt;</span><span class=nx>도시</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{city}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;도시를 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;street&#34;</span><span class=p>&gt;</span><span class=nx>거리</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{street}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;거리를 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;zipcode&#34;</span><span class=p>&gt;</span><span class=nx>우편번호</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{zipcode}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;우편번호를 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span><span class=p>&gt;</span><span class=nx>Submit</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>br</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><hr><h2 id=회원-목록-조회>회원 목록 조회<a hidden class=anchor aria-hidden=true href=#회원-목록-조회>#</a></h2><p><strong>회원 목록 컨트롤러 추가</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MemberController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>//추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/members&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=n>members</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberService</span><span class=p>.</span><span class=na>findMembers</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;members&#34;</span><span class=p>,</span><span class=w> </span><span class=n>members</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;members/memberList&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span></code></pre></div><blockquote><p><details><summary markdown=span><strong>회원 목록 뷰</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>table</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;table table-striped&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=err>#</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>이름</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>도시</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>주소</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>우편번호</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>tr</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;member : ${members}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.id}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.name}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.address?.city}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.address?.street}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.address?.zipcode}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><p>타임리프에서 ?를 사용하면 null을 무시한다.</p><hr><h2 id=상품-등록>상품 등록<a hidden class=anchor aria-hidden=true href=#상품-등록>#</a></h2><p><strong>상품 등록 폼</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Getter</span><span class=w> </span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BookForm</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>stockQuantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>author</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>isbn</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>상품 등록 컨트롤러</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/items/new&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>createForm</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;form&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BookForm</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;items/createItemForm&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/items/new&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>create</span><span class=p>(</span><span class=n>BookForm</span><span class=w> </span><span class=n>form</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Book</span><span class=w> </span><span class=n>book</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Book</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getName</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setPrice</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setStockQuantity</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getStockQuantity</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setAuthor</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getAuthor</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setIsbn</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getIsbn</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>itemService</span><span class=p>.</span><span class=na>saveItem</span><span class=p>(</span><span class=n>book</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>create메서드에서 Book을 set으로 BookForm의 값들을 하나씩 대입하는것보다 엔티티에 생성 메서드를 만드는게 좋다.</p><blockquote><p><details><summary markdown=span><strong>상품 등록 뷰</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>th</span><span class=err>:</span><span class=na>action</span><span class=o>=</span><span class=s>&#34;@{/items/new}&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>object</span><span class=o>=</span><span class=s>&#34;${form}&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>&gt;</span><span class=nx>상품명</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{name}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;이름을 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;price&#34;</span><span class=p>&gt;</span><span class=nx>가격</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{price}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;가격을 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;stockQuantity&#34;</span><span class=p>&gt;</span><span class=nx>수량</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{stockQuantity}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;수량을 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;author&#34;</span><span class=p>&gt;</span><span class=nx>저자</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{author}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;저자를 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;isbn&#34;</span><span class=p>&gt;</span><span class=nx>ISBN</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{isbn}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;ISBN을 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span><span class=p>&gt;</span><span class=nx>Submit</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>br</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><ul><li>상품 등록 폼에서 데이터를 입력하고 Submit 버튼을 클릭하면 /items/new를 POST 방식으로 요청</li><li>상품 저장이 끝나면 상품 목록 화면(redirect:/items)으로 리다이렉트</li></ul><hr><h2 id=상품-목록>상품 목록<a hidden class=anchor aria-hidden=true href=#상품-목록>#</a></h2><p><strong>상품 목록 컨트롤러</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/items&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>list</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Item</span><span class=o>&gt;</span><span class=w> </span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>itemService</span><span class=p>.</span><span class=na>findItems</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;items&#34;</span><span class=p>,</span><span class=w> </span><span class=n>items</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;items/itemList&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><details><summary markdown=span><strong>상품 목록 뷰</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>table</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;table table-striped&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=err>#</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>상품명</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>가격</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>재고수량</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tr</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;item : ${items}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.id}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.name}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.price}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.stockQuantity}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;#&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>href</span><span class=o>=</span><span class=s>&#34;@{/items/{id}/edit (id=${item.id})}&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span> <span class=na>role</span><span class=o>=</span><span class=s>&#34;button&#34;</span><span class=p>&gt;</span><span class=nx>수정</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><hr><h2 id=상품-수정>상품 수정<a hidden class=anchor aria-hidden=true href=#상품-수정>#</a></h2><p><strong>상품 수정과 관련된 컨트롤러 코드</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>//상품 수정 폼 추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/items/{itemId}/edit&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>updateItemForm</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;itemId&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Book</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=w> </span><span class=n>itemService</span><span class=p>.</span><span class=na>findOne</span><span class=p>(</span><span class=n>itemId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BookForm</span><span class=w> </span><span class=n>form</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>BookForm</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getName</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setPrice</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setStockQuantity</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getStockQuantity</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setAuthor</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getAuthor</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>form</span><span class=p>.</span><span class=na>setIsbn</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getIsbn</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;form&#34;</span><span class=p>,</span><span class=w> </span><span class=n>form</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;items/updateItemForm&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/items/{itemId}/edit&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>updateItem</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=nd>@ModelAttribute</span><span class=p>(</span><span class=s>&#34;form&#34;</span><span class=p>)</span><span class=w> </span><span class=n>BookForm</span><span class=w> </span><span class=n>form</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Book</span><span class=w> </span><span class=n>book</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Book</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getName</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setPrice</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setStockQuantity</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getStockQuantity</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setAuthor</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getAuthor</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>book</span><span class=p>.</span><span class=na>setIsbn</span><span class=p>(</span><span class=n>form</span><span class=p>.</span><span class=na>getIsbn</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>itemService</span><span class=p>.</span><span class=na>saveItem</span><span class=p>(</span><span class=n>book</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/items&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><details><summary markdown=span><strong>상품 수정 폼 화면</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>th</span><span class=err>:</span><span class=na>object</span><span class=o>=</span><span class=s>&#34;${form}&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--</span> <span class=nx>id</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;hidden&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{id}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>&gt;</span><span class=nx>상품명</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{name}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;이름을 입력하세요&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;price&#34;</span><span class=p>&gt;</span><span class=nx>가격</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{price}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;가격을 입력하세요&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;stockQuantity&#34;</span><span class=p>&gt;</span><span class=nx>수량</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{stockQuantity}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;수량을 입력하세요&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;author&#34;</span><span class=p>&gt;</span><span class=nx>저자</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{author}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;저자를 입력하세요&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>th</span><span class=err>:</span><span class=na>for</span><span class=o>=</span><span class=s>&#34;isbn&#34;</span><span class=p>&gt;</span><span class=nx>ISBN</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{isbn}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;ISBN을 입력하세요&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span><span class=p>&gt;</span><span class=nx>Submit</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><p><strong>상품 수정 폼 이동</strong></p><ol><li>수정 버튼을 선택하면 /items/{itemId}/edit URL을 GET 방식으로 요청</li><li>그 결과로 updateItemForm() 메서드를 실행하는데 이 메서드는 itemService.fondOne(itemId)를 호출해서 수정할 상품을 조회</li><li>조회 결과를 모델 객체에 담아서 뷰(items/updateItemForm)에 전달</li></ol><p><strong>상품 수정 실행</strong></p><ol><li>상품 수정 폼에서 정보를 수정하고 Submit 버튼을 선택</li><li>/items/{itemId}/edit URL을 POST방식으로 요청하고 updateItem() 메서드를 실행</li><li>이때 컨트롤러에 파라미터로 넘어온 Item 엔티티 인스턴스는 현재 준영속 상태다. 따라서 영속성 컨텍스트의 지원을 받을 수 없고 데이터를 수정해도 변경 감지 기능은 동작X</li></ol><hr><h2 id=변경-감지와-병합merge>변경 감지와 병합(merge)<a hidden class=anchor aria-hidden=true href=#변경-감지와-병합merge>#</a></h2><p><strong>준영속 엔티티</strong></p><p>영속성 컨텍스트가 더는 관리하지 않는 엔티티를 말한다.
(여기서는itemService.saveItem(book)에서 수정을 시도하는 Book 객체다.) <strong>Book 객체는 이미 DB에 한번 저장되어서 식별자가 존재</strong>한다. 이렇게 임의로 만들어낸 엔티티도 기존 식별자를 가지고 있으면 준영속 엔티티로 볼 수있다.</p><p><strong>준영속 엔티티를 수정하는 2가지 방법</strong></p><ul><li>변경 감지 기능 사용</li><li>병합(merge)사용</li></ul><h3 id=변경-감지-기능-사용><strong>변경 감지 기능 사용</strong><a hidden class=anchor aria-hidden=true href=#변경-감지-기능-사용>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Transactional</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>void</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Item</span><span class=w> </span><span class=n>itemParam</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>//itemParam: 파리미터로 넘어온 준영속 상태의 엔티티</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Item</span><span class=w> </span><span class=n>findItem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>em</span><span class=p>.</span><span class=na>find</span><span class=p>(</span><span class=n>Item</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>itemParam</span><span class=p>.</span><span class=na>getId</span><span class=p>());</span><span class=w> </span><span class=c1>//같은 엔티티를 조회한다.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>findItem</span><span class=p>.</span><span class=na>setPrice</span><span class=p>(</span><span class=n>itemParam</span><span class=p>.</span><span class=na>getPrice</span><span class=p>());</span><span class=w> </span><span class=c1>//데이터를 수정한다.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>영속성 컨텍스트에서 엔티티를 다시 조회한 후에 데이터를 수정하는 방법읻. 트랜잭션 안에서 엔티티를 다시 조회, 변경 할 값 선택후 트랜잭션 커밋 시점에 변경감지가 동작해서 데이터베이스에 UPDATE SQL 실행한다.</p><h3 id=병합사용><strong>병합사용</strong><a hidden class=anchor aria-hidden=true href=#병합사용>#</a></h3><p>병합은 준영속 상태의 엔티티를 영속 상태로 변경할 때 사용하는 기능이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Transactional</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>void</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Item</span><span class=w> </span><span class=n>itemParam</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>//itemParam: 파리미터로 넘어온 준영속 상태의 엔티티</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Item</span><span class=w> </span><span class=n>mergeItem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>em</span><span class=p>.</span><span class=na>merge</span><span class=p>(</span><span class=n>itemParam</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><strong>병합: 기존에 있는 엔티티</strong></p><p><img loading=lazy src=images/image.png alt=image.png></p><p>병합시 동작 방식을 간단히 정리</p><ol><li>준영속 엔티티의 식별자 값으로 영속 엔티티를 조회한다.</li><li>영속 엔티티의 값을 준영속 엔티티의 값으로 모두 교체한다.(병합한다.)</li><li>트랜잭션 커밋 시점에 변경 감지 기능이 동작해서 데이터베이스에 UPDATE SQL이 실행</li></ol><blockquote><p>주의: 변경 감지 기능을 사용하면 원하는 속성만 선택해서 변경할 수 있지만, 병합을 사용하면 모든 속성이 변경된다. 병합시 값이 없으면 null로 업데이트 할 위험도 있다. (병합은 모든 필드를 교체한다.)</p></blockquote><h3 id=상품-리포지토리의-저장-메서드-분석-itemrepository>상품 리포지토리의 저장 메서드 분석 ItemRepository<a hidden class=anchor aria-hidden=true href=#상품-리포지토리의-저장-메서드-분석-itemrepository>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemRepository</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EntityManager</span><span class=w> </span><span class=n>em</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>save</span><span class=p>(</span><span class=n>Item</span><span class=w> </span><span class=n>item</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getId</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>em</span><span class=p>.</span><span class=na>persist</span><span class=p>(</span><span class=n>item</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>em</span><span class=p>.</span><span class=na>merge</span><span class=p>(</span><span class=n>item</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><ul><li>save() 메서드는 식별자 값이 없으면(null) 새로운 엔티티로 판단해서 영속화(persist)하고 식별자가 있으면 병합(merge)</li><li>지금처럼 준영속 상태인 상품 엔티티를 수정할 때는 id값이 있으므로 병합 수행</li></ul><blockquote><p>실무에서는 보통 업데이트 기능이 매우 제한적이다. 그런데 병합은 모든 필드를 변경해버리고, 데이터가 없으면 null 로 업데이트 해버린다. 병합을 사용하면서 이 문제를 해결하려면, 변경 폼 화면에서 모든 데이터를 항
상 유지해야 한다. <strong>실무에서는 보통 변경가능한 데이터만 노출하기 때문에, 병합을 사용하는 것이 오히려 번거롭다.</strong></p></blockquote><p><strong>그럼 변경감지와 병합중 어떤 것을 써야할까?</strong></p><p>가장 좋은 해결방법은 엔티티를 변경할때는 항상 변경감지를 상용하는 것이다.</p><ul><li>컨트롤러에서 어설프게 엔티티를 생성 X</li><li>트랜잭션이 있는 서비스 계층에 식별자(id)와 변경할 데이터를 명확하게 전달(파라미터 or dto)</li><li>트랜잭션이 있는 서비스 계층에서 영속 상태의 엔티티를 조회하고, 엔티티의 데이터를 직접 변경</li><li>트랜잭션 커밋 시점에 변경 감지가 실행됩니다.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//....</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/items/{itemId}/edit&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>updateItem</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=nd>@ModelAttribute</span><span class=p>(</span><span class=s>&#34;form&#34;</span><span class=p>)</span><span class=w> </span><span class=n>BookForm</span><span class=w> </span><span class=n>form</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>itemService</span><span class=p>.</span><span class=na>updateItem</span><span class=p>(</span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=n>form</span><span class=p>.</span><span class=na>getName</span><span class=p>(),</span><span class=w> </span><span class=n>form</span><span class=p>.</span><span class=na>getPrice</span><span class=p>(),</span><span class=w> </span><span class=n>form</span><span class=p>.</span><span class=na>getStockQuantity</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/items&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Transactional</span><span class=p>(</span><span class=n>readOnly</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ItemService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemRepository</span><span class=w> </span><span class=n>itemRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Transactional</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>updateItem</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>price</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>stockQuantity</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Item</span><span class=w> </span><span class=n>finditem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>itemRepository</span><span class=p>.</span><span class=na>findOne</span><span class=p>(</span><span class=n>itemId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>finditem</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=n>name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>finditem</span><span class=p>.</span><span class=na>setPrice</span><span class=p>(</span><span class=n>price</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>finditem</span><span class=p>.</span><span class=na>setStockQuantity</span><span class=p>(</span><span class=n>stockQuantity</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><hr><h2 id=상품-주문>상품 주문<a hidden class=anchor aria-hidden=true href=#상품-주문>#</a></h2><p><strong>상품 주문 컨트롤러</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>OrderService</span><span class=w> </span><span class=n>orderService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberService</span><span class=w> </span><span class=n>memberService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/order&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>creatForm</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Member</span><span class=o>&gt;</span><span class=w> </span><span class=n>members</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>memberService</span><span class=p>.</span><span class=na>findMembers</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Item</span><span class=o>&gt;</span><span class=w> </span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>itemService</span><span class=p>.</span><span class=na>findItems</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;members&#34;</span><span class=p>,</span><span class=w> </span><span class=n>members</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;items&#34;</span><span class=p>,</span><span class=w> </span><span class=n>items</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;order/orderForm&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/order&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>order</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;memberId&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>memberId</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;itemId&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;count&#34;</span><span class=p>)</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderService</span><span class=p>.</span><span class=na>order</span><span class=p>(</span><span class=n>memberId</span><span class=p>,</span><span class=w> </span><span class=n>itemId</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/orders&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>주문 폼 이동</p><ul><li>메인 화면에서 상품 주문을 선택하면 /order를 GET방식으로 호출</li><li>OrderController의 createForm() 메서드</li><li>주문 화면에는 주문할 고객정보와 상품 정보가 필요하므로 model객체에 담아서 뷰에 넘겨줌</li></ul><p>주문 실행</p><ul><li><p>주문할 회원과 상품 그리고 수량을 선택해서 Submit 버튼을 누르면 /order URL을 POST 방식으로 호출</p></li><li><p>컨트롤러의 order() 메서드 실행</p></li><li><p>이 메서드는 고객 식별자(memberId), 주문할 상품 식별자(itemId), 수량(count)정보를 받아서 주문 서비스에 주문을 요청</p></li><li><p>주문이 끝나면 상품 주문 내역이 있는 /orders URL로 리다이렉트</p></li><li><p>상품 주문 폼</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>role</span><span class=o>=</span><span class=s>&#34;form&#34;</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/order&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;member&#34;</span><span class=p>&gt;</span><span class=nx>주문회원</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>select</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;memberId&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;member&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span><span class=nx>회원선택</span><span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>option</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;member : ${members}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>th</span><span class=err>:</span><span class=na>value</span><span class=o>=</span><span class=s>&#34;${member.id}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${member.name}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;item&#34;</span><span class=p>&gt;</span><span class=nx>상품명</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>select</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;itemId&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;item&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span><span class=nx>상품선택</span><span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>option</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;item : ${items}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>th</span><span class=err>:</span><span class=na>value</span><span class=o>=</span><span class=s>&#34;${item.id}&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.name}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;count&#34;</span><span class=p>&gt;</span><span class=nx>주문수량</span><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;count&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;count&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;주문 수량을 입력하세요&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary&#34;</span><span class=p>&gt;</span><span class=nx>Submit</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>br</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></li></ul><hr><h2 id=주문-목록-검색-취소>주문 목록 검색, 취소<a hidden class=anchor aria-hidden=true href=#주문-목록-검색-취소>#</a></h2><p><strong>주문 목록</strong></p><p><strong>검색 컨트롤러</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>OrderService</span><span class=w> </span><span class=n>orderService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberService</span><span class=w> </span><span class=n>memberService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/orders&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>orderList</span><span class=p>(</span><span class=nd>@ModelAttribute</span><span class=p>(</span><span class=s>&#34;orderSearch&#34;</span><span class=p>)</span><span class=w> </span><span class=n>OrderSearch</span><span class=w> </span><span class=n>orderSearch</span><span class=p>,</span><span class=w> </span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderService</span><span class=p>.</span><span class=na>findOrders</span><span class=p>(</span><span class=n>orderSearch</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;orders&#34;</span><span class=p>,</span><span class=w> </span><span class=n>orders</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;order/orderList&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><details><summary markdown=span>주문 목록 검색 화면</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>xmlns</span><span class=err>:</span><span class=na>th</span><span class=o>=</span><span class=s>&#34;http://www.thymeleaf.org&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/header :: header&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/bodyHeader :: bodyHeader&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>form</span> <span class=na>th</span><span class=err>:</span><span class=na>object</span><span class=o>=</span><span class=s>&#34;${orderSearch}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-inline&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group mb-2&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{memberName}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;회원명&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-group mx-sm-1 mb-2&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>select</span> <span class=na>th</span><span class=err>:</span><span class=na>field</span><span class=o>=</span><span class=s>&#34;*{orderStatus}&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span><span class=nx>주문상태</span><span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;status : ${T(jpabook.jpashop.domain.OrderStatus).values()}&#34;</span>
</span></span><span class=line><span class=cl>                                <span class=na>th</span><span class=err>:</span><span class=na>value</span><span class=o>=</span><span class=s>&#34;${status}&#34;</span>
</span></span><span class=line><span class=cl>                                <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${status}&#34;</span><span class=p>&gt;</span><span class=nx>option</span>
</span></span><span class=line><span class=cl>                        <span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-primary mb-2&#34;</span><span class=p>&gt;</span><span class=nx>검색</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>table</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;table table-striped&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=err>#</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>회원명</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>대표상품</span> <span class=nx>이름</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>대표상품</span> <span class=nx>주문가격</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>대표상품</span> <span class=nx>주문수량</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>상태</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span><span class=nx>일시</span><span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>thead</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>tr</span> <span class=na>th</span><span class=err>:</span><span class=na>each</span><span class=o>=</span><span class=s>&#34;item : ${orders}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.id}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.member.name}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.orderItems[0].item.name}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.orderItems[0].orderPrice}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.orderItems[0].count}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.status}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span> <span class=na>th</span><span class=err>:</span><span class=na>text</span><span class=o>=</span><span class=s>&#34;${item.orderDate}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>a</span> <span class=na>th</span><span class=err>:</span><span class=na>if</span><span class=o>=</span><span class=s>&#34;${item.status.name() == &#39;ORDER&#39;}&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;#&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>th</span><span class=err>:</span><span class=na>href</span><span class=o>=</span><span class=s>&#34;&#39;javascript:cancel(&#39;+${item.id}+&#39;)&#39;&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-danger&#34;</span><span class=p>&gt;</span><span class=nx>CANCEL</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>tbody</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>th</span><span class=err>:</span><span class=na>replace</span><span class=o>=</span><span class=s>&#34;fragments/footer :: footer&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!--</span> <span class=o>/</span><span class=nx>container</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>cancel</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>form</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;form&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>form</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;method&#34;</span><span class=p>,</span> <span class=s2>&#34;post&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>form</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;action&#34;</span><span class=p>,</span> <span class=s2>&#34;/orders/&#34;</span> <span class=o>+</span> <span class=nx>id</span> <span class=o>+</span> <span class=s2>&#34;/cancel&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>form</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>form</span><span class=p>.</span><span class=nx>submit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div></details></p></blockquote><p><strong>주문 취소</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>OrderService</span><span class=w> </span><span class=n>orderService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>MemberService</span><span class=w> </span><span class=n>memberService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ItemService</span><span class=w> </span><span class=n>itemService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/orders/{orderId}/cancel&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>cancelOrder</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;orderId&#34;</span><span class=p>)</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>orderId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderService</span><span class=p>.</span><span class=na>cancelOrder</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;redirect:/orders&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://yosong6729.github.io/tags/spring-boot/>Spring Boot</a></li><li><a href=https://yosong6729.github.io/tags/jpa/>JPA</a></li></ul><nav class=paginav><a class=prev href=https://yosong6729.github.io/post/api-%EA%B0%9C%EB%B0%9C-%EA%B8%B0%EB%B3%B8/><span class=title>« Prev</span><br><span>API 개발 기본</span>
</a><a class=next href=https://yosong6729.github.io/post/%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B0%9C%EB%B0%9C/><span class=title>Next »</span><br><span>도메인 개발</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yosong6729.github.io/>Yosong6729 Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>